#+title: Deep Learning
#+subtitle: Neural Networks for Data Analytics
#+author: Alberto Valdez
#+SETUPFILE: ../config/org-theme-alt.config
#+SETUPFILE: ../config/org-header.config

* Deep Learning
:PROPERTIES:
:CUSTOM_ID: deep-learning
:END:

** Neural Networks
:PROPERTIES:
:CUSTOM_ID: neural-networks
:END:

A Neural Network is a model that will allow us to find complex patterns and compare them against the result. The fundamentals of NN are the same as other Machine Learning Models. The difference is that the topology of the NNs is modeled after the connectivity of the human brain.

Neural Networks take an input and generate a set of layers (composed as a collection of perceptrons), each of these perceptrons are connected to the previous and next layers via weighted linear connections.

NNs aren't very interpretable as the results from the interactions of each layer and its perceptrons don't mean anything in relationship with the data. The layers of perceptron are connected and weighted against one another until the execution reaches the final, outer layer. All executions use every part of the neural network.

** Perceptrons
:PROPERTIES:
:CUSTOM_ID: perceptrons
:END:

The Perceptron has the ability to learn with a linear classification technique (it is a model itself). Depending on the input given to the perceptron, each of its nodes will be either activated or not, and then on the way out, the result will have a certain weight applied.

The perceptrons have inputs, weights, bias and an activation function. The bias has always a value of 1 which helps us give a consistent output in case none of the inputs go through. Perceptrons can do linear and non-linear predictions.

We start with a set of random weights, then the *retro-propagation algorithm* will adjust the weights based on how wrong the first iteration is. We can stop this process with an arbitrary limit or until the model fails.

Once many perceptrons make a prediction, we start to get a better prediction.

We have many types of activation functions:

- linear (any)
- sigmoid (between 0 and 1)
- tanh (-1 to 1)
- rectified linear unit (only positive linear)
- leaky rectified linear unit (reduced slope on negative values).

* Neural Networks in Python
:PROPERTIES:
:CUSTOM_ID: neural-networks-in-python
:END:

** Tensorflow and Keras
:PROPERTIES:
:CUSTOM_ID: tensorflow-and-keras
:END:

Keras provides a lot of types of NNs, for example: Sequential class and the Dense class. Once we have a Keras model created, we can proceed with Model -> Fit -> Predict[fn:2].

Keras also provides various activation functions[fn:1].

** Imports
:PROPERTIES:
:CUSTOM_ID: imports
:END:

#+begin_src python :exports code
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.datasets import make_blobs
import sklearn as skl
import tensorflow as tf
#+end_src

#+RESULTS[380bd8288bdf8ddff17d36771f854fadee4245a7]:
#+begin_example
2022-11-01 20:20:16.618654: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
#+end_example

** Generate Data
:PROPERTIES:
:CUSTOM_ID: generate-data
:END:

#+begin_src python :results file :wrap org
X, y = make_blobs(n_samples=1000, centers=2, n_features=2, random_state=78)

df = pd.DataFrame(X, columns=["Feature 1", "Feature 2"])
df["Target"] = y

file = "../resources/test1.png"
fig, ax = plt.subplots(figsize=(5, 3))

ax.scatter(x=df["Feature 1"].values, y=df["Feature 2"].values, c=df["Target"].values, cmap="viridis")

fig.savefig(file)
print(file)
#+end_src

#+RESULTS[07496ece66ba703c6c4e7be224b5958d5f7a57ea]:
#+begin_org
[[file:../resources/test1.png]]
#+end_org

** Prepare the Data
:PROPERTIES:
:CUSTOM_ID: prepare-the-data
:END:

#+begin_src python
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=78)

X_scaler = skl.preprocessing.StandardScaler()

X_scaler.fit(X_train)

X_train_scaled = X_scaler.transform(X_train)
X_test_scaled = X_scaler.transform(X_test)

print(X_train_scaled.shape, X_test_scaled.shape)
#+end_src

#+RESULTS[1d2740649d1b2ebf1c43c4beb11bf77f91fcb35c]:
#+begin_example
(750, 2) (250, 2)
#+end_example

** Create and Layer the Model
:PROPERTIES:
:CUSTOM_ID: create-and-layer-the-model
:END:

We first create our model, then we can add layers to it using the =Dense= class. We need a few parameters,

- =input_dim= indicates how many inputs in the model (in this case two).
- =units= indicates how many neurons we want in the hidden layer.
- =activation= indicates which activation function to use. We'll use =ReLU= to deal with the non-linear relationships of our data.

Our first layer will have a =relu= function. Then for our output player, we will use the =sigmoid= function. We don't need an input in our second layer as it is densely connected to the previous one.

#+begin_src python
nn_model = tf.keras.models.Sequential()

nn_model.add(tf.keras.layers.Dense(units=3, activation="relu", input_dim=2))

nn_model.add(tf.keras.layers.Dense(units=1, activation="sigmoid"))

print(nn_model.summary())
#+end_src

#+RESULTS[a75af7352ed45db2f5229879d56e4226e8d9016b]:
#+begin_example
2022-11-01 20:20:33.206517: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 dense (Dense)               (None, 3)                 9

 dense_1 (Dense)             (None, 1)                 4

=================================================================
Total params: 13
Trainable params: 13
Non-trainable params: 0
_________________________________________________________________
None
#+end_example

Note that the biases are included in the Param column, so if we have 3 units, we get a total of 9 (thrice) the parameters.

** Train the model
:PROPERTIES:
:CUSTOM_ID: train-the-model
:END:

We are optimizing the "binary_crossentropy" using the "adam" optimizer and will report the "accuracy" of the model.

The back-propagation works from the output to the input and adjusts all the weights in each layer. It shows the NN the whole dataset as many times as Epochs. With 100 Epochs, the NN will do 80,000 changes to the weights.

#+begin_src python
nn_model.compile(loss="binary_crossentropy", optimizer="adam", metrics=["accuracy"])

fit_model = nn_model.fit(X_train_scaled, y_train, epochs=100)
#+end_src

** Visualize the Results
:PROPERTIES:
:CUSTOM_ID: visualize-the-results
:END:

We are optimizing for the loss so we will observe that it decreases gradually for each iteration.

#+begin_src python :results file :wrap org
history_df = pd.DataFrame(fit_model.history, index=range(1,len(fit_model.history["loss"])+1))

file = "../resources/loss1.png"
fig, ax = plt.subplots(figsize=(6, 4))
ax.plot(history_df["loss"])
fig.savefig(file)
print(file)
#+end_src

#+RESULTS[3955c1299e3b60182ac520408b79d3ba293d9054]:
#+begin_org
[[file:../resources/loss1.png]]
#+end_org

However, we are not optimizing for accuracy, which will give us a different behaviour.

#+begin_src python :results file :wrap org
file = "../resources/accuracy1.png"
fig, ax = plt.subplots(figsize=(6, 4))
ax.plot(history_df["accuracy"])
fig.savefig(file)
print(file)
#+end_src

#+RESULTS[1f37f9ff0432a0a962726e7d6f2571cbbd406b34]:
#+begin_org
[[file:../resources/accuracy1.png]]
#+end_org

** Evaluate the Model
:PROPERTIES:
:CUSTOM_ID: evaluate-the-model
:END:

#+begin_src python
model_loss, model_accuracy = nn_model.evaluate(X_test_scaled,y_test,verbose=2)

print(f"Loss: {model_loss}, Accuracy: {model_accuracy}")
#+end_src

#+RESULTS[009c452718b647972374329330a23931b9a86052]:
#+begin_example
8/8 - 0s - loss: 0.0044 - accuracy: 1.0000 - 195ms/epoch - 24ms/step
Loss: 0.004448498599231243, Accuracy: 1.0
#+end_example

** Re-training the model
:PROPERTIES:
:CUSTOM_ID: re-training-the-model
:END:

We can compare the results of the model with different Epochs, always trying to not overfit the data.

#+begin_src python
nn_model.compile(loss="binary_crossentropy", optimizer="adam", metrics=["accuracy"])

fit_model = nn_model.fit(X_train_scaled, y_train, epochs=300)

history_df = pd.DataFrame(fit_model.history, index=range(1,len(fit_model.history["loss"])+1))
#+end_src

#+RESULTS[3e838f15cb1f26eda0f25b0b051f1d0eb15cb679]:
#+begin_example
Epoch 1/300
 1/24 [>.............................] - ETA: 9s - loss: 0.0070 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0046 - accuracy: 1.0000
Epoch 2/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0043 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0039 - accuracy: 1.0000
Epoch 3/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0035 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0033 - accuracy: 1.0000
Epoch 4/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0026 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0028 - accuracy: 1.0000
Epoch 5/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0019 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0024 - accuracy: 1.0000
Epoch 6/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0021 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0021 - accuracy: 1.0000
Epoch 7/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0020 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0019 - accuracy: 1.0000
Epoch 8/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0015 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0016 - accuracy: 1.0000
Epoch 9/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0011 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0015 - accuracy: 1.0000
Epoch 10/300
 1/24 [>.............................] - ETA: 0s - loss: 9.9524e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0013 - accuracy: 1.0000
Epoch 11/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0014 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0012 - accuracy: 1.0000
Epoch 12/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0012 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0011 - accuracy: 1.0000
Epoch 13/300
 1/24 [>.............................] - ETA: 0s - loss: 8.5731e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.0010 - accuracy: 1.0000
Epoch 14/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0015 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 9.2139e-04 - accuracy: 1.0000
Epoch 15/300
 1/24 [>.............................] - ETA: 0s - loss: 0.0011 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 8.4982e-04 - accuracy: 1.0000
Epoch 16/300
 1/24 [>.............................] - ETA: 0s - loss: 8.7364e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 7.8591e-04 - accuracy: 1.0000
Epoch 17/300
 1/24 [>.............................] - ETA: 0s - loss: 8.6571e-04 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 7.2974e-04 - accuracy: 1.0000
Epoch 18/300
 1/24 [>.............................] - ETA: 0s - loss: 9.5303e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.7873e-04 - accuracy: 1.0000
Epoch 19/300
 1/24 [>.............................] - ETA: 0s - loss: 5.3871e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.3333e-04 - accuracy: 1.0000
Epoch 20/300
 1/24 [>.............................] - ETA: 0s - loss: 8.4919e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.9213e-04 - accuracy: 1.0000
Epoch 21/300
 1/24 [>.............................] - ETA: 0s - loss: 6.2630e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.5499e-04 - accuracy: 1.0000
Epoch 22/300
 1/24 [>.............................] - ETA: 0s - loss: 4.5841e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.2162e-04 - accuracy: 1.0000
Epoch 23/300
 1/24 [>.............................] - ETA: 0s - loss: 6.3146e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.9126e-04 - accuracy: 1.0000
Epoch 24/300
 1/24 [>.............................] - ETA: 0s - loss: 4.5226e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.6307e-04 - accuracy: 1.0000
Epoch 25/300
 1/24 [>.............................] - ETA: 0s - loss: 4.5574e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.3819e-04 - accuracy: 1.0000
Epoch 26/300
 1/24 [>.............................] - ETA: 0s - loss: 4.1715e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.1479e-04 - accuracy: 1.0000
Epoch 27/300
 1/24 [>.............................] - ETA: 0s - loss: 2.9666e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.9282e-04 - accuracy: 1.0000
Epoch 28/300
 1/24 [>.............................] - ETA: 0s - loss: 2.5777e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.7289e-04 - accuracy: 1.0000
Epoch 29/300
 1/24 [>.............................] - ETA: 0s - loss: 2.7870e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.5463e-04 - accuracy: 1.0000
Epoch 30/300
 1/24 [>.............................] - ETA: 0s - loss: 4.8906e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.3763e-04 - accuracy: 1.0000
Epoch 31/300
 1/24 [>.............................] - ETA: 0s - loss: 2.5666e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.2167e-04 - accuracy: 1.0000
Epoch 32/300
 1/24 [>.............................] - ETA: 0s - loss: 3.8645e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.0729e-04 - accuracy: 1.0000
Epoch 33/300
 1/24 [>.............................] - ETA: 0s - loss: 2.3636e-04 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.9324e-04 - accuracy: 1.0000
Epoch 34/300
 1/24 [>.............................] - ETA: 0s - loss: 6.6597e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.8063e-04 - accuracy: 1.0000
Epoch 35/300
 1/24 [>.............................] - ETA: 0s - loss: 4.3637e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.6850e-04 - accuracy: 1.0000
Epoch 36/300
 1/24 [>.............................] - ETA: 0s - loss: 2.0561e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.5732e-04 - accuracy: 1.0000
Epoch 37/300
 1/24 [>.............................] - ETA: 0s - loss: 2.2472e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.4696e-04 - accuracy: 1.0000
Epoch 38/300
 1/24 [>.............................] - ETA: 0s - loss: 2.5873e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.3682e-04 - accuracy: 1.0000
Epoch 39/300
 1/24 [>.............................] - ETA: 0s - loss: 2.2011e-04 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.2745e-04 - accuracy: 1.0000
Epoch 40/300
 1/24 [>.............................] - ETA: 0s - loss: 1.8354e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.1874e-04 - accuracy: 1.0000
Epoch 41/300
 1/24 [>.............................] - ETA: 0s - loss: 1.3227e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.1044e-04 - accuracy: 1.0000
Epoch 42/300
 1/24 [>.............................] - ETA: 0s - loss: 1.2816e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.0260e-04 - accuracy: 1.0000
Epoch 43/300
 1/24 [>.............................] - ETA: 0s - loss: 1.3704e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.9514e-04 - accuracy: 1.0000
Epoch 44/300
 1/24 [>.............................] - ETA: 0s - loss: 5.2889e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.8810e-04 - accuracy: 1.0000
Epoch 45/300
 1/24 [>.............................] - ETA: 0s - loss: 1.2752e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.8141e-04 - accuracy: 1.0000
Epoch 46/300
 1/24 [>.............................] - ETA: 0s - loss: 1.6131e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.7499e-04 - accuracy: 1.0000
Epoch 47/300
 1/24 [>.............................] - ETA: 0s - loss: 1.1111e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.6915e-04 - accuracy: 1.0000
Epoch 48/300
 1/24 [>.............................] - ETA: 0s - loss: 2.6549e-04 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.6339e-04 - accuracy: 1.0000
Epoch 49/300
 1/24 [>.............................] - ETA: 0s - loss: 1.8247e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.5794e-04 - accuracy: 1.0000
Epoch 50/300
 1/24 [>.............................] - ETA: 0s - loss: 1.3250e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.5286e-04 - accuracy: 1.0000
Epoch 51/300
 1/24 [>.............................] - ETA: 0s - loss: 1.1193e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.4783e-04 - accuracy: 1.0000
Epoch 52/300
 1/24 [>.............................] - ETA: 0s - loss: 1.5294e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.4310e-04 - accuracy: 1.0000
Epoch 53/300
 1/24 [>.............................] - ETA: 0s - loss: 1.1711e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.3845e-04 - accuracy: 1.0000
Epoch 54/300
 1/24 [>.............................] - ETA: 0s - loss: 1.1759e-04 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.3417e-04 - accuracy: 1.0000
Epoch 55/300
 1/24 [>.............................] - ETA: 0s - loss: 3.9857e-04 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.3017e-04 - accuracy: 1.0000
Epoch 56/300
 1/24 [>.............................] - ETA: 0s - loss: 9.6042e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.2613e-04 - accuracy: 1.0000
Epoch 57/300
 1/24 [>.............................] - ETA: 0s - loss: 7.4993e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.2234e-04 - accuracy: 1.0000
Epoch 58/300
 1/24 [>.............................] - ETA: 0s - loss: 1.6904e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.1884e-04 - accuracy: 1.0000
Epoch 59/300
 1/24 [>.............................] - ETA: 0s - loss: 8.3532e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.1530e-04 - accuracy: 1.0000
Epoch 60/300
 1/24 [>.............................] - ETA: 0s - loss: 1.0210e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.1199e-04 - accuracy: 1.0000
Epoch 61/300
 1/24 [>.............................] - ETA: 0s - loss: 6.9077e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.0885e-04 - accuracy: 1.0000
Epoch 62/300
 1/24 [>.............................] - ETA: 0s - loss: 6.6719e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.0571e-04 - accuracy: 1.0000
Epoch 63/300
 1/24 [>.............................] - ETA: 0s - loss: 8.9155e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.0276e-04 - accuracy: 1.0000
Epoch 64/300
 1/24 [>.............................] - ETA: 0s - loss: 7.9998e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 9.9949e-05 - accuracy: 1.0000
Epoch 65/300
 1/24 [>.............................] - ETA: 0s - loss: 8.7308e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 9.7152e-05 - accuracy: 1.0000
Epoch 66/300
 1/24 [>.............................] - ETA: 0s - loss: 7.0890e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 9.4563e-05 - accuracy: 1.0000
Epoch 67/300
 1/24 [>.............................] - ETA: 0s - loss: 1.0675e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 9.2103e-05 - accuracy: 1.0000
Epoch 68/300
 1/24 [>.............................] - ETA: 0s - loss: 7.4178e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 8.9669e-05 - accuracy: 1.0000
Epoch 69/300
 1/24 [>.............................] - ETA: 0s - loss: 8.3020e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 8.7325e-05 - accuracy: 1.0000
Epoch 70/300
 1/24 [>.............................] - ETA: 0s - loss: 7.4351e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 8.5141e-05 - accuracy: 1.0000
Epoch 71/300
 1/24 [>.............................] - ETA: 0s - loss: 7.6816e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 8.2954e-05 - accuracy: 1.0000
Epoch 72/300
 1/24 [>.............................] - ETA: 0s - loss: 2.9026e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 8.0871e-05 - accuracy: 1.0000
Epoch 73/300
 1/24 [>.............................] - ETA: 0s - loss: 2.9323e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 7.8857e-05 - accuracy: 1.0000
Epoch 74/300
 1/24 [>.............................] - ETA: 0s - loss: 4.7870e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 7.6925e-05 - accuracy: 1.0000
Epoch 75/300
 1/24 [>.............................] - ETA: 0s - loss: 7.1223e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 7.5016e-05 - accuracy: 1.0000
Epoch 76/300
 1/24 [>.............................] - ETA: 0s - loss: 6.3275e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 7.3214e-05 - accuracy: 1.0000
Epoch 77/300
 1/24 [>.............................] - ETA: 0s - loss: 6.8386e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 7.1453e-05 - accuracy: 1.0000
Epoch 78/300
 1/24 [>.............................] - ETA: 0s - loss: 5.3503e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.9618e-05 - accuracy: 1.0000
Epoch 79/300
 1/24 [>.............................] - ETA: 0s - loss: 4.2336e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.7968e-05 - accuracy: 1.0000
Epoch 80/300
 1/24 [>.............................] - ETA: 0s - loss: 5.0457e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.6346e-05 - accuracy: 1.0000
Epoch 81/300
 1/24 [>.............................] - ETA: 0s - loss: 4.0425e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.4838e-05 - accuracy: 1.0000
Epoch 82/300
 1/24 [>.............................] - ETA: 0s - loss: 4.0205e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 6.3368e-05 - accuracy: 1.0000
Epoch 83/300
 1/24 [>.............................] - ETA: 0s - loss: 4.1614e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 6.1914e-05 - accuracy: 1.0000
Epoch 84/300
 1/24 [>.............................] - ETA: 0s - loss: 3.0818e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.0535e-05 - accuracy: 1.0000
Epoch 85/300
 1/24 [>.............................] - ETA: 0s - loss: 3.5800e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.9165e-05 - accuracy: 1.0000
Epoch 86/300
 1/24 [>.............................] - ETA: 0s - loss: 4.2616e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.7865e-05 - accuracy: 1.0000
Epoch 87/300
 1/24 [>.............................] - ETA: 0s - loss: 3.5285e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.6614e-05 - accuracy: 1.0000
Epoch 88/300
 1/24 [>.............................] - ETA: 0s - loss: 4.1418e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.5352e-05 - accuracy: 1.0000
Epoch 89/300
 1/24 [>.............................] - ETA: 0s - loss: 4.6019e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 5.4181e-05 - accuracy: 1.0000
Epoch 90/300
 1/24 [>.............................] - ETA: 0s - loss: 4.4266e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 5.2995e-05 - accuracy: 1.0000
Epoch 91/300
 1/24 [>.............................] - ETA: 0s - loss: 4.2376e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.1934e-05 - accuracy: 1.0000
Epoch 92/300
 1/24 [>.............................] - ETA: 0s - loss: 2.8700e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.0764e-05 - accuracy: 1.0000
Epoch 93/300
 1/24 [>.............................] - ETA: 0s - loss: 5.2085e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.9720e-05 - accuracy: 1.0000
Epoch 94/300
 1/24 [>.............................] - ETA: 0s - loss: 1.7184e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 4.8664e-05 - accuracy: 1.0000
Epoch 95/300
 1/24 [>.............................] - ETA: 0s - loss: 4.3991e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.7676e-05 - accuracy: 1.0000
Epoch 96/300
 1/24 [>.............................] - ETA: 0s - loss: 2.5750e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 4.6679e-05 - accuracy: 1.0000
Epoch 97/300
 1/24 [>.............................] - ETA: 0s - loss: 3.6478e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.5748e-05 - accuracy: 1.0000
Epoch 98/300
 1/24 [>.............................] - ETA: 0s - loss: 3.9640e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.4832e-05 - accuracy: 1.0000
Epoch 99/300
 1/24 [>.............................] - ETA: 0s - loss: 6.4279e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.3914e-05 - accuracy: 1.0000
Epoch 100/300
 1/24 [>.............................] - ETA: 0s - loss: 3.4231e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.3027e-05 - accuracy: 1.0000
Epoch 101/300
 1/24 [>.............................] - ETA: 0s - loss: 4.3813e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 4.2187e-05 - accuracy: 1.0000
Epoch 102/300
 1/24 [>.............................] - ETA: 0s - loss: 3.1582e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 4.1365e-05 - accuracy: 1.0000
Epoch 103/300
 1/24 [>.............................] - ETA: 0s - loss: 6.0987e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.0549e-05 - accuracy: 1.0000
Epoch 104/300
 1/24 [>.............................] - ETA: 0s - loss: 2.5005e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.9754e-05 - accuracy: 1.0000
Epoch 105/300
 1/24 [>.............................] - ETA: 0s - loss: 1.8589e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.8986e-05 - accuracy: 1.0000
Epoch 106/300
 1/24 [>.............................] - ETA: 0s - loss: 4.5191e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.8225e-05 - accuracy: 1.0000
Epoch 107/300
 1/24 [>.............................] - ETA: 0s - loss: 4.3179e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 3.7503e-05 - accuracy: 1.0000
Epoch 108/300
 1/24 [>.............................] - ETA: 0s - loss: 3.5625e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 3.6784e-05 - accuracy: 1.0000
Epoch 109/300
 1/24 [>.............................] - ETA: 0s - loss: 2.5613e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.6089e-05 - accuracy: 1.0000
Epoch 110/300
 1/24 [>.............................] - ETA: 0s - loss: 2.7551e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.5428e-05 - accuracy: 1.0000
Epoch 111/300
 1/24 [>.............................] - ETA: 0s - loss: 1.8194e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.4738e-05 - accuracy: 1.0000
Epoch 112/300
 1/24 [>.............................] - ETA: 0s - loss: 3.4463e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.4096e-05 - accuracy: 1.0000
Epoch 113/300
 1/24 [>.............................] - ETA: 0s - loss: 1.8709e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 3.3464e-05 - accuracy: 1.0000
Epoch 114/300
 1/24 [>.............................] - ETA: 0s - loss: 2.2707e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.2862e-05 - accuracy: 1.0000
Epoch 115/300
 1/24 [>.............................] - ETA: 0s - loss: 2.1384e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.2238e-05 - accuracy: 1.0000
Epoch 116/300
 1/24 [>.............................] - ETA: 0s - loss: 3.7122e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.1653e-05 - accuracy: 1.0000
Epoch 117/300
 1/24 [>.............................] - ETA: 0s - loss: 2.6661e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.1101e-05 - accuracy: 1.0000
Epoch 118/300
 1/24 [>.............................] - ETA: 0s - loss: 1.4971e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.0526e-05 - accuracy: 1.0000
Epoch 119/300
 1/24 [>.............................] - ETA: 0s - loss: 2.8628e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.9953e-05 - accuracy: 1.0000
Epoch 120/300
 1/24 [>.............................] - ETA: 0s - loss: 1.7654e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.9411e-05 - accuracy: 1.0000
Epoch 121/300
 1/24 [>.............................] - ETA: 0s - loss: 2.0086e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.8878e-05 - accuracy: 1.0000
Epoch 122/300
 1/24 [>.............................] - ETA: 0s - loss: 3.9440e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.8372e-05 - accuracy: 1.0000
Epoch 123/300
 1/24 [>.............................] - ETA: 0s - loss: 1.2310e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.7862e-05 - accuracy: 1.0000
Epoch 124/300
 1/24 [>.............................] - ETA: 0s - loss: 3.3721e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.7379e-05 - accuracy: 1.0000
Epoch 125/300
 1/24 [>.............................] - ETA: 0s - loss: 2.1097e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.6905e-05 - accuracy: 1.0000
Epoch 126/300
 1/24 [>.............................] - ETA: 0s - loss: 1.8281e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.6427e-05 - accuracy: 1.0000
Epoch 127/300
 1/24 [>.............................] - ETA: 0s - loss: 1.6765e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.5989e-05 - accuracy: 1.0000
Epoch 128/300
 1/24 [>.............................] - ETA: 0s - loss: 2.2484e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.5518e-05 - accuracy: 1.0000
Epoch 129/300
 1/24 [>.............................] - ETA: 0s - loss: 2.4360e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.5090e-05 - accuracy: 1.0000
Epoch 130/300
 1/24 [>.............................] - ETA: 0s - loss: 1.4719e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.4646e-05 - accuracy: 1.0000
Epoch 131/300
 1/24 [>.............................] - ETA: 0s - loss: 2.1228e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.4236e-05 - accuracy: 1.0000
Epoch 132/300
 1/24 [>.............................] - ETA: 0s - loss: 1.2719e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.3820e-05 - accuracy: 1.0000
Epoch 133/300
 1/24 [>.............................] - ETA: 0s - loss: 1.2093e-04 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.3449e-05 - accuracy: 1.0000
Epoch 134/300
 1/24 [>.............................] - ETA: 0s - loss: 2.2296e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.3036e-05 - accuracy: 1.0000
Epoch 135/300
 1/24 [>.............................] - ETA: 0s - loss: 1.8890e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.2633e-05 - accuracy: 1.0000
Epoch 136/300
 1/24 [>.............................] - ETA: 0s - loss: 1.4900e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.2275e-05 - accuracy: 1.0000
Epoch 137/300
 1/24 [>.............................] - ETA: 0s - loss: 1.6575e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.1891e-05 - accuracy: 1.0000
Epoch 138/300
 1/24 [>.............................] - ETA: 0s - loss: 3.7185e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.1507e-05 - accuracy: 1.0000
Epoch 139/300
 1/24 [>.............................] - ETA: 0s - loss: 1.6400e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.1123e-05 - accuracy: 1.0000
Epoch 140/300
 1/24 [>.............................] - ETA: 0s - loss: 1.2179e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.0782e-05 - accuracy: 1.0000
Epoch 141/300
 1/24 [>.............................] - ETA: 0s - loss: 8.5898e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.0439e-05 - accuracy: 1.0000
Epoch 142/300
 1/24 [>.............................] - ETA: 0s - loss: 1.0722e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.0110e-05 - accuracy: 1.0000
Epoch 143/300
 1/24 [>.............................] - ETA: 0s - loss: 1.4830e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.9781e-05 - accuracy: 1.0000
Epoch 144/300
 1/24 [>.............................] - ETA: 0s - loss: 2.8241e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.9462e-05 - accuracy: 1.0000
Epoch 145/300
 1/24 [>.............................] - ETA: 0s - loss: 1.0879e-04 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.9162e-05 - accuracy: 1.0000
Epoch 146/300
 1/24 [>.............................] - ETA: 0s - loss: 2.4638e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.8843e-05 - accuracy: 1.0000
Epoch 147/300
 1/24 [>.............................] - ETA: 0s - loss: 1.6534e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.8543e-05 - accuracy: 1.0000
Epoch 148/300
 1/24 [>.............................] - ETA: 0s - loss: 1.6207e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.8240e-05 - accuracy: 1.0000
Epoch 149/300
 1/24 [>.............................] - ETA: 0s - loss: 1.5597e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.7955e-05 - accuracy: 1.0000
Epoch 150/300
 1/24 [>.............................] - ETA: 0s - loss: 1.1973e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.7672e-05 - accuracy: 1.0000
Epoch 151/300
 1/24 [>.............................] - ETA: 0s - loss: 1.1285e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.7394e-05 - accuracy: 1.0000
Epoch 152/300
 1/24 [>.............................] - ETA: 0s - loss: 1.1054e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.7122e-05 - accuracy: 1.0000
Epoch 153/300
 1/24 [>.............................] - ETA: 0s - loss: 2.2927e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.6855e-05 - accuracy: 1.0000
Epoch 154/300
 1/24 [>.............................] - ETA: 0s - loss: 1.4543e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.6584e-05 - accuracy: 1.0000
Epoch 155/300
 1/24 [>.............................] - ETA: 0s - loss: 1.2234e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.6343e-05 - accuracy: 1.0000
Epoch 156/300
 1/24 [>.............................] - ETA: 0s - loss: 1.2201e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.6074e-05 - accuracy: 1.0000
Epoch 157/300
 1/24 [>.............................] - ETA: 0s - loss: 7.5179e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.5834e-05 - accuracy: 1.0000
Epoch 158/300
 1/24 [>.............................] - ETA: 0s - loss: 9.3235e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.5587e-05 - accuracy: 1.0000
Epoch 159/300
 1/24 [>.............................] - ETA: 0s - loss: 2.3133e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.5346e-05 - accuracy: 1.0000
Epoch 160/300
 1/24 [>.............................] - ETA: 0s - loss: 1.0791e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.5109e-05 - accuracy: 1.0000
Epoch 161/300
 1/24 [>.............................] - ETA: 0s - loss: 9.7459e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.4874e-05 - accuracy: 1.0000
Epoch 162/300
 1/24 [>.............................] - ETA: 0s - loss: 1.1231e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.4643e-05 - accuracy: 1.0000
Epoch 163/300
 1/24 [>.............................] - ETA: 0s - loss: 1.3822e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.4414e-05 - accuracy: 1.0000
Epoch 164/300
 1/24 [>.............................] - ETA: 0s - loss: 5.4868e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.4194e-05 - accuracy: 1.0000
Epoch 165/300
 1/24 [>.............................] - ETA: 0s - loss: 8.0786e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.4000e-05 - accuracy: 1.0000
Epoch 166/300
 1/24 [>.............................] - ETA: 0s - loss: 8.5975e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.3767e-05 - accuracy: 1.0000
Epoch 167/300
 1/24 [>.............................] - ETA: 0s - loss: 8.6916e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.3558e-05 - accuracy: 1.0000
Epoch 168/300
 1/24 [>.............................] - ETA: 0s - loss: 9.1783e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.3355e-05 - accuracy: 1.0000
Epoch 169/300
 1/24 [>.............................] - ETA: 0s - loss: 1.3967e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.3148e-05 - accuracy: 1.0000
Epoch 170/300
 1/24 [>.............................] - ETA: 0s - loss: 1.7406e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.2967e-05 - accuracy: 1.0000
Epoch 171/300
 1/24 [>.............................] - ETA: 0s - loss: 2.1024e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.2766e-05 - accuracy: 1.0000
Epoch 172/300
 1/24 [>.............................] - ETA: 0s - loss: 7.3817e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.2580e-05 - accuracy: 1.0000
Epoch 173/300
 1/24 [>.............................] - ETA: 0s - loss: 8.3485e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.2387e-05 - accuracy: 1.0000
Epoch 174/300
 1/24 [>.............................] - ETA: 0s - loss: 9.1606e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.2207e-05 - accuracy: 1.0000
Epoch 175/300
 1/24 [>.............................] - ETA: 0s - loss: 6.3636e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.2026e-05 - accuracy: 1.0000
Epoch 176/300
 1/24 [>.............................] - ETA: 0s - loss: 9.1242e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.1849e-05 - accuracy: 1.0000
Epoch 177/300
 1/24 [>.............................] - ETA: 0s - loss: 9.9609e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.1669e-05 - accuracy: 1.0000
Epoch 178/300
 1/24 [>.............................] - ETA: 0s - loss: 5.7741e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.1506e-05 - accuracy: 1.0000
Epoch 179/300
 1/24 [>.............................] - ETA: 0s - loss: 6.5037e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.1331e-05 - accuracy: 1.0000
Epoch 180/300
 1/24 [>.............................] - ETA: 0s - loss: 7.9814e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.1163e-05 - accuracy: 1.0000
Epoch 181/300
 1/24 [>.............................] - ETA: 0s - loss: 6.4584e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.1006e-05 - accuracy: 1.0000
Epoch 182/300
 1/24 [>.............................] - ETA: 0s - loss: 7.4697e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.0843e-05 - accuracy: 1.0000
Epoch 183/300
 1/24 [>.............................] - ETA: 0s - loss: 7.6878e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 1.0682e-05 - accuracy: 1.0000
Epoch 184/300
 1/24 [>.............................] - ETA: 0s - loss: 7.3418e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.0530e-05 - accuracy: 1.0000
Epoch 185/300
 1/24 [>.............................] - ETA: 0s - loss: 6.6093e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.0374e-05 - accuracy: 1.0000
Epoch 186/300
 1/24 [>.............................] - ETA: 0s - loss: 5.9939e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.0223e-05 - accuracy: 1.0000
Epoch 187/300
 1/24 [>.............................] - ETA: 0s - loss: 5.4410e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 1.0082e-05 - accuracy: 1.0000
Epoch 188/300
 1/24 [>.............................] - ETA: 0s - loss: 7.1123e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 9.9331e-06 - accuracy: 1.0000
Epoch 189/300
 1/24 [>.............................] - ETA: 0s - loss: 4.6989e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 9.7857e-06 - accuracy: 1.0000
Epoch 190/300
 1/24 [>.............................] - ETA: 0s - loss: 1.3583e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 9.6490e-06 - accuracy: 1.0000
Epoch 191/300
 1/24 [>.............................] - ETA: 0s - loss: 7.4967e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 9.5210e-06 - accuracy: 1.0000
Epoch 192/300
 1/24 [>.............................] - ETA: 0s - loss: 1.2394e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 9.3773e-06 - accuracy: 1.0000
Epoch 193/300
 1/24 [>.............................] - ETA: 0s - loss: 6.4367e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 9.2437e-06 - accuracy: 1.0000
Epoch 194/300
 1/24 [>.............................] - ETA: 0s - loss: 7.4810e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 9.1175e-06 - accuracy: 1.0000
Epoch 195/300
 1/24 [>.............................] - ETA: 0s - loss: 5.6458e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 8.9860e-06 - accuracy: 1.0000
Epoch 196/300
 1/24 [>.............................] - ETA: 0s - loss: 7.5340e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 8.8583e-06 - accuracy: 1.0000
Epoch 197/300
 1/24 [>.............................] - ETA: 0s - loss: 9.9659e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 8.7338e-06 - accuracy: 1.0000
Epoch 198/300
 1/24 [>.............................] - ETA: 0s - loss: 3.3552e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 8.6147e-06 - accuracy: 1.0000
Epoch 199/300
 1/24 [>.............................] - ETA: 0s - loss: 8.5158e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 8.4900e-06 - accuracy: 1.0000
Epoch 200/300
 1/24 [>.............................] - ETA: 0s - loss: 6.3485e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 8.3692e-06 - accuracy: 1.0000
Epoch 201/300
 1/24 [>.............................] - ETA: 0s - loss: 1.2062e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 8.2500e-06 - accuracy: 1.0000
Epoch 202/300
 1/24 [>.............................] - ETA: 0s - loss: 5.4240e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 8.1357e-06 - accuracy: 1.0000
Epoch 203/300
 1/24 [>.............................] - ETA: 0s - loss: 9.5195e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 8.0189e-06 - accuracy: 1.0000
Epoch 204/300
 1/24 [>.............................] - ETA: 0s - loss: 9.0204e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 7.9089e-06 - accuracy: 1.0000
Epoch 205/300
 1/24 [>.............................] - ETA: 0s - loss: 5.9634e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 7.7987e-06 - accuracy: 1.0000
Epoch 206/300
 1/24 [>.............................] - ETA: 0s - loss: 5.2330e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 7.6964e-06 - accuracy: 1.0000
Epoch 207/300
 1/24 [>.............................] - ETA: 0s - loss: 5.0506e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 7.5793e-06 - accuracy: 1.0000
Epoch 208/300
 1/24 [>.............................] - ETA: 0s - loss: 6.8525e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 7.4742e-06 - accuracy: 1.0000
Epoch 209/300
 1/24 [>.............................] - ETA: 0s - loss: 3.8776e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 7.3703e-06 - accuracy: 1.0000
Epoch 210/300
 1/24 [>.............................] - ETA: 0s - loss: 4.3983e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 7.2699e-06 - accuracy: 1.0000
Epoch 211/300
 1/24 [>.............................] - ETA: 0s - loss: 2.8366e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 7.1633e-06 - accuracy: 1.0000
Epoch 212/300
 1/24 [>.............................] - ETA: 0s - loss: 3.2754e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 7.0688e-06 - accuracy: 1.0000
Epoch 213/300
 1/24 [>.............................] - ETA: 0s - loss: 4.0851e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 6.9758e-06 - accuracy: 1.0000
Epoch 214/300
 1/24 [>.............................] - ETA: 0s - loss: 2.7603e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 6.8712e-06 - accuracy: 1.0000
Epoch 215/300
 1/24 [>.............................] - ETA: 0s - loss: 3.4205e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.7743e-06 - accuracy: 1.0000
Epoch 216/300
 1/24 [>.............................] - ETA: 0s - loss: 3.3937e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.6885e-06 - accuracy: 1.0000
Epoch 217/300
 1/24 [>.............................] - ETA: 0s - loss: 5.2662e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.5886e-06 - accuracy: 1.0000
Epoch 218/300
 1/24 [>.............................] - ETA: 0s - loss: 4.5390e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.4995e-06 - accuracy: 1.0000
Epoch 219/300
 1/24 [>.............................] - ETA: 0s - loss: 2.0894e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 6.4071e-06 - accuracy: 1.0000
Epoch 220/300
 1/24 [>.............................] - ETA: 0s - loss: 1.3850e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 6.3210e-06 - accuracy: 1.0000
Epoch 221/300
 1/24 [>.............................] - ETA: 0s - loss: 3.5126e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.2292e-06 - accuracy: 1.0000
Epoch 222/300
 1/24 [>.............................] - ETA: 0s - loss: 3.1351e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.1474e-06 - accuracy: 1.0000
Epoch 223/300
 1/24 [>.............................] - ETA: 0s - loss: 2.6669e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 6.0612e-06 - accuracy: 1.0000
Epoch 224/300
 1/24 [>.............................] - ETA: 0s - loss: 2.7483e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 5.9819e-06 - accuracy: 1.0000
Epoch 225/300
 1/24 [>.............................] - ETA: 0s - loss: 3.0694e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.8986e-06 - accuracy: 1.0000
Epoch 226/300
 1/24 [>.............................] - ETA: 0s - loss: 2.8887e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.8155e-06 - accuracy: 1.0000
Epoch 227/300
 1/24 [>.............................] - ETA: 0s - loss: 3.8065e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.7292e-06 - accuracy: 1.0000
Epoch 228/300
 1/24 [>.............................] - ETA: 0s - loss: 2.4919e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.6383e-06 - accuracy: 1.0000
Epoch 229/300
 1/24 [>.............................] - ETA: 0s - loss: 2.4523e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.5606e-06 - accuracy: 1.0000
Epoch 230/300
 1/24 [>.............................] - ETA: 0s - loss: 4.1972e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.4878e-06 - accuracy: 1.0000
Epoch 231/300
 1/24 [>.............................] - ETA: 0s - loss: 3.5080e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 5.4143e-06 - accuracy: 1.0000
Epoch 232/300
 1/24 [>.............................] - ETA: 0s - loss: 3.3752e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.3455e-06 - accuracy: 1.0000
Epoch 233/300
 1/24 [>.............................] - ETA: 0s - loss: 2.5561e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.2708e-06 - accuracy: 1.0000
Epoch 234/300
 1/24 [>.............................] - ETA: 0s - loss: 3.9051e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.2002e-06 - accuracy: 1.0000
Epoch 235/300
 1/24 [>.............................] - ETA: 0s - loss: 3.5717e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 5.1301e-06 - accuracy: 1.0000
Epoch 236/300
 1/24 [>.............................] - ETA: 0s - loss: 3.7367e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 5.0629e-06 - accuracy: 1.0000
Epoch 237/300
 1/24 [>.............................] - ETA: 0s - loss: 4.0154e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 4.9995e-06 - accuracy: 1.0000
Epoch 238/300
 1/24 [>.............................] - ETA: 0s - loss: 4.1387e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.9280e-06 - accuracy: 1.0000
Epoch 239/300
 1/24 [>.............................] - ETA: 0s - loss: 2.1068e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.8637e-06 - accuracy: 1.0000
Epoch 240/300
 1/24 [>.............................] - ETA: 0s - loss: 3.3516e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.8025e-06 - accuracy: 1.0000
Epoch 241/300
 1/24 [>.............................] - ETA: 0s - loss: 5.5446e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 4.7354e-06 - accuracy: 1.0000
Epoch 242/300
 1/24 [>.............................] - ETA: 0s - loss: 6.2008e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.6730e-06 - accuracy: 1.0000
Epoch 243/300
 1/24 [>.............................] - ETA: 0s - loss: 6.1468e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.6116e-06 - accuracy: 1.0000
Epoch 244/300
 1/24 [>.............................] - ETA: 0s - loss: 4.6571e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.5499e-06 - accuracy: 1.0000
Epoch 245/300
 1/24 [>.............................] - ETA: 0s - loss: 1.9931e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.4893e-06 - accuracy: 1.0000
Epoch 246/300
 1/24 [>.............................] - ETA: 0s - loss: 3.3186e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 4.4294e-06 - accuracy: 1.0000
Epoch 247/300
 1/24 [>.............................] - ETA: 0s - loss: 3.5258e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.3716e-06 - accuracy: 1.0000
Epoch 248/300
 1/24 [>.............................] - ETA: 0s - loss: 2.3696e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 4.3191e-06 - accuracy: 1.0000
Epoch 249/300
 1/24 [>.............................] - ETA: 0s - loss: 1.8863e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.2412e-06 - accuracy: 1.0000
Epoch 250/300
 1/24 [>.............................] - ETA: 0s - loss: 3.4182e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.1874e-06 - accuracy: 1.0000
Epoch 251/300
 1/24 [>.............................] - ETA: 0s - loss: 1.9380e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 4.1301e-06 - accuracy: 1.0000
Epoch 252/300
 1/24 [>.............................] - ETA: 0s - loss: 4.2184e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 4.0791e-06 - accuracy: 1.0000
Epoch 253/300
 1/24 [>.............................] - ETA: 0s - loss: 2.7050e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 4.0234e-06 - accuracy: 1.0000
Epoch 254/300
 1/24 [>.............................] - ETA: 0s - loss: 2.7445e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 3.9684e-06 - accuracy: 1.0000
Epoch 255/300
 1/24 [>.............................] - ETA: 0s - loss: 1.7394e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.9164e-06 - accuracy: 1.0000
Epoch 256/300
 1/24 [>.............................] - ETA: 0s - loss: 3.0475e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.8648e-06 - accuracy: 1.0000
Epoch 257/300
 1/24 [>.............................] - ETA: 0s - loss: 2.3813e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.8143e-06 - accuracy: 1.0000
Epoch 258/300
 1/24 [>.............................] - ETA: 0s - loss: 2.8917e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.7642e-06 - accuracy: 1.0000
Epoch 259/300
 1/24 [>.............................] - ETA: 0s - loss: 2.1715e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 3.7150e-06 - accuracy: 1.0000
Epoch 260/300
 1/24 [>.............................] - ETA: 0s - loss: 3.3537e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.6671e-06 - accuracy: 1.0000
Epoch 261/300
 1/24 [>.............................] - ETA: 0s - loss: 1.8921e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.6188e-06 - accuracy: 1.0000
Epoch 262/300
 1/24 [>.............................] - ETA: 0s - loss: 2.6834e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.5727e-06 - accuracy: 1.0000
Epoch 263/300
 1/24 [>.............................] - ETA: 0s - loss: 1.7961e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 3.5260e-06 - accuracy: 1.0000
Epoch 264/300
 1/24 [>.............................] - ETA: 0s - loss: 1.9076e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 3.4797e-06 - accuracy: 1.0000
Epoch 265/300
 1/24 [>.............................] - ETA: 0s - loss: 2.7875e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.4368e-06 - accuracy: 1.0000
Epoch 266/300
 1/24 [>.............................] - ETA: 0s - loss: 3.4364e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.3910e-06 - accuracy: 1.0000
Epoch 267/300
 1/24 [>.............................] - ETA: 0s - loss: 1.4637e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 3.3465e-06 - accuracy: 1.0000
Epoch 268/300
 1/24 [>.............................] - ETA: 0s - loss: 2.8078e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 3.3101e-06 - accuracy: 1.0000
Epoch 269/300
 1/24 [>.............................] - ETA: 0s - loss: 1.3914e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.2600e-06 - accuracy: 1.0000
Epoch 270/300
 1/24 [>.............................] - ETA: 0s - loss: 2.1862e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.2208e-06 - accuracy: 1.0000
Epoch 271/300
 1/24 [>.............................] - ETA: 0s - loss: 1.4921e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.1743e-06 - accuracy: 1.0000
Epoch 272/300
 1/24 [>.............................] - ETA: 0s - loss: 1.6038e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.1355e-06 - accuracy: 1.0000
Epoch 273/300
 1/24 [>.............................] - ETA: 0s - loss: 2.2233e-05 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 3.0971e-06 - accuracy: 1.0000
Epoch 274/300
 1/24 [>.............................] - ETA: 0s - loss: 1.5137e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.0532e-06 - accuracy: 1.0000
Epoch 275/300
 1/24 [>.............................] - ETA: 0s - loss: 2.1187e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 3.0173e-06 - accuracy: 1.0000
Epoch 276/300
 1/24 [>.............................] - ETA: 0s - loss: 1.5378e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.9759e-06 - accuracy: 1.0000
Epoch 277/300
 1/24 [>.............................] - ETA: 0s - loss: 2.3188e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.9399e-06 - accuracy: 1.0000
Epoch 278/300
 1/24 [>.............................] - ETA: 0s - loss: 1.6882e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.9006e-06 - accuracy: 1.0000
Epoch 279/300
 1/24 [>.............................] - ETA: 0s - loss: 1.6855e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.8637e-06 - accuracy: 1.0000
Epoch 280/300
 1/24 [>.............................] - ETA: 0s - loss: 2.1161e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.8265e-06 - accuracy: 1.0000
Epoch 281/300
 1/24 [>.............................] - ETA: 0s - loss: 7.4892e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.7922e-06 - accuracy: 1.0000
Epoch 282/300
 1/24 [>.............................] - ETA: 0s - loss: 3.9926e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.7546e-06 - accuracy: 1.0000
Epoch 283/300
 1/24 [>.............................] - ETA: 0s - loss: 3.3682e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.7222e-06 - accuracy: 1.0000
Epoch 284/300
 1/24 [>.............................] - ETA: 0s - loss: 3.7347e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.6841e-06 - accuracy: 1.0000
Epoch 285/300
 1/24 [>.............................] - ETA: 0s - loss: 8.1602e-07 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.6504e-06 - accuracy: 1.0000
Epoch 286/300
 1/24 [>.............................] - ETA: 0s - loss: 1.4664e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.6155e-06 - accuracy: 1.0000
Epoch 287/300
 1/24 [>.............................] - ETA: 0s - loss: 1.7919e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.5878e-06 - accuracy: 1.0000
Epoch 288/300
 1/24 [>.............................] - ETA: 0s - loss: 1.7957e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.5491e-06 - accuracy: 1.0000
Epoch 289/300
 1/24 [>.............................] - ETA: 0s - loss: 4.1930e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.5170e-06 - accuracy: 1.0000
Epoch 290/300
 1/24 [>.............................] - ETA: 0s - loss: 1.8961e-05 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.4867e-06 - accuracy: 1.0000
Epoch 291/300
 1/24 [>.............................] - ETA: 0s - loss: 1.1994e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.4531e-06 - accuracy: 1.0000
Epoch 292/300
 1/24 [>.............................] - ETA: 0s - loss: 4.1158e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.4215e-06 - accuracy: 1.0000
Epoch 293/300
 1/24 [>.............................] - ETA: 0s - loss: 1.3995e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.3919e-06 - accuracy: 1.0000
Epoch 294/300
 1/24 [>.............................] - ETA: 0s - loss: 1.3759e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.3604e-06 - accuracy: 1.0000
Epoch 295/300
 1/24 [>.............................] - ETA: 0s - loss: 1.6201e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.3308e-06 - accuracy: 1.0000
Epoch 296/300
 1/24 [>.............................] - ETA: 0s - loss: 1.7302e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.2989e-06 - accuracy: 1.0000
Epoch 297/300
 1/24 [>.............................] - ETA: 0s - loss: 2.6042e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.2639e-06 - accuracy: 1.0000
Epoch 298/300
 1/24 [>.............................] - ETA: 0s - loss: 2.0528e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.2327e-06 - accuracy: 1.0000
Epoch 299/300
 1/24 [>.............................] - ETA: 0s - loss: 1.3459e-06 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 2.1993e-06 - accuracy: 1.0000
Epoch 300/300
 1/24 [>.............................] - ETA: 0s - loss: 1.7629e-06 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 2.1700e-06 - accuracy: 1.0000
#+end_example

#+begin_src python :results file :wrap org
file = "../resources/loss2.png"
fig, ax = plt.subplots(figsize=(6, 4))
ax.plot(history_df["loss"])
fig.savefig(file)
print(file)
#+end_src

#+RESULTS[a22ec64f008dfe0267ff99d1bcc134879798c0fd]:
#+begin_org
[[file:../resources/loss2.png]]
#+end_org

We see that the loss curve tends to a zero-slope after somewhere between 80 and 100 epochs, this means that we have overfitted it because we didn't need as many epochs as we gave it.

#+begin_src python :results file :wrap org
file = "../resources/accuracy2.png"
fig, ax = plt.subplots(figsize=(6, 4))
ax.plot(history_df["accuracy"])
fig.savefig(file)
print(file)
#+end_src

#+RESULTS[c47271d00efcb739dc526dfe52cc31e95531c94a]:
#+begin_org
[[file:../resources/accuracy2.png]]
#+end_org

* Neural Network Example 2
:PROPERTIES:
:CUSTOM_ID: neural-network-example-2
:END:

** Imports
:PROPERTIES:
:CUSTOM_ID: imports
:END:

#+begin_src python :exports code
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.datasets import make_blobs
import sklearn as skl
import tensorflow as tf
#+end_src

#+RESULTS[380bd8288bdf8ddff17d36771f854fadee4245a7]:
#+begin_example
#+end_example

** Load Data
:PROPERTIES:
:CUSTOM_ID: load-data
:END:

#+begin_src python :results file :wrap org
X, y = make_blobs(n_samples=5000, centers=2, n_features=2, random_state=42, cluster_std=3)

df = pd.DataFrame(X, columns=["Feature 1", "Feature 2"])
df["Target"] = y

file = "../resources/test2.png"
fig, ax = plt.subplots(figsize=(6, 4))
ax.scatter(df["Feature 1"], df["Feature 2"], c=df["Target"], cmap="winter")
ax.set_title("Blob data 2")
fig.savefig(file)
print(file)
#+end_src

#+RESULTS[defc8cd3ef192488e7957c23169d85936399089b]:
#+begin_org
[[file:../resources/test2.png]]
#+end_org

#+begin_src python
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=78)

X_scaler = skl.preprocessing.StandardScaler()

X_scaler.fit(X_train)

X_train_scaled = X_scaler.transform(X_train)
X_test_scaled = X_scaler.transform(X_test)

print(X_train_scaled.shape, X_test_scaled.shape)
#+end_src

** Create and Layer the Model
:PROPERTIES:
:CUSTOM_ID: create-and-layer-the-model
:END:

We will create two additional Dense layers.

#+begin_src python
nn_model = tf.keras.models.Sequential()

nn_model.add(tf.keras.layers.Dense(units=3, activation="relu", input_dim=2))

nn_model.add(tf.keras.layers.Dense(units=3, activation="sigmoid"))

nn_model.add(tf.keras.layers.Dense(units=1, activation="tanh"))

print(nn_model.summary())
#+end_src

#+RESULTS[058e8c49d2de091461268affdf35cb1683c73c7b]:
#+begin_example
Model: "sequential_4"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 dense_9 (Dense)             (None, 3)                 9

 dense_10 (Dense)            (None, 3)                 12

 dense_11 (Dense)            (None, 1)                 4

=================================================================
Total params: 25
Trainable params: 25
Non-trainable params: 0
_________________________________________________________________
None
#+end_example

** Compile and Train the Model
:PROPERTIES:
:CUSTOM_ID: compile-and-train-the-model
:END:

#+begin_src python
nn_model.compile(loss="binary_crossentropy", optimizer="adam", metrics=["accuracy"])

fit_model = nn_model.fit(X_train_scaled, y_train, epochs=75)
#+end_src

#+RESULTS[e801df707e7b7adf789ee2f73793a0802df64fbf]:
#+begin_example
Epoch 1/75
  1/118 [..............................] - ETA: 1:05 - loss: 0.8092 - accuracy: 0.4062 32/118 [=======>......................] - ETA: 0s - loss: 0.7154 - accuracy: 0.4980   71/118 [=================>............] - ETA: 0s - loss: 0.6875 - accuracy: 0.5136107/118 [==========================>...] - ETA: 0s - loss: 0.6647 - accuracy: 0.6107118/118 [==============================] - 1s 1ms/step - loss: 0.6588 - accuracy: 0.6352
Epoch 2/75
  1/118 [..............................] - ETA: 0s - loss: 0.5925 - accuracy: 0.9062 26/118 [=====>........................] - ETA: 0s - loss: 0.5781 - accuracy: 0.9099 51/118 [===========>..................] - ETA: 0s - loss: 0.5666 - accuracy: 0.9105 80/118 [===================>..........] - ETA: 0s - loss: 0.5496 - accuracy: 0.9215107/118 [==========================>...] - ETA: 0s - loss: 0.5363 - accuracy: 0.9235118/118 [==============================] - 0s 2ms/step - loss: 0.5306 - accuracy: 0.9243
Epoch 3/75
  1/118 [..............................] - ETA: 0s - loss: 0.4533 - accuracy: 0.9688 28/118 [======>.......................] - ETA: 0s - loss: 0.4531 - accuracy: 0.9286 56/118 [=============>................] - ETA: 0s - loss: 0.4371 - accuracy: 0.9330 80/118 [===================>..........] - ETA: 0s - loss: 0.4223 - accuracy: 0.9340108/118 [==========================>...] - ETA: 0s - loss: 0.4037 - accuracy: 0.9363118/118 [==============================] - 0s 2ms/step - loss: 0.3986 - accuracy: 0.9360
Epoch 4/75
  1/118 [..............................] - ETA: 0s - loss: 0.3646 - accuracy: 0.9062 32/118 [=======>......................] - ETA: 0s - loss: 0.3194 - accuracy: 0.9375 68/118 [================>.............] - ETA: 0s - loss: 0.3061 - accuracy: 0.9416103/118 [=========================>....] - ETA: 0s - loss: 0.2924 - accuracy: 0.9390118/118 [==============================] - 0s 2ms/step - loss: 0.2883 - accuracy: 0.9387
Epoch 5/75
  1/118 [..............................] - ETA: 0s - loss: 0.3026 - accuracy: 0.9062 27/118 [=====>........................] - ETA: 0s - loss: 0.2422 - accuracy: 0.9421 57/118 [=============>................] - ETA: 0s - loss: 0.2341 - accuracy: 0.9446 82/118 [===================>..........] - ETA: 0s - loss: 0.2344 - accuracy: 0.9447112/118 [===========================>..] - ETA: 0s - loss: 0.2345 - accuracy: 0.9425118/118 [==============================] - 0s 2ms/step - loss: 0.2333 - accuracy: 0.9424
Epoch 6/75
  1/118 [..............................] - ETA: 0s - loss: 0.1664 - accuracy: 0.9688 27/118 [=====>........................] - ETA: 0s - loss: 0.1953 - accuracy: 0.9595 53/118 [============>.................] - ETA: 0s - loss: 0.1981 - accuracy: 0.9522 54/118 [============>.................] - ETA: 0s - loss: 0.1982 - accuracy: 0.9520 82/118 [===================>..........] - ETA: 0s - loss: 0.2010 - accuracy: 0.9459105/118 [=========================>....] - ETA: 0s - loss: 0.2036 - accuracy: 0.9438118/118 [==============================] - 0s 3ms/step - loss: 0.2027 - accuracy: 0.9419
Epoch 7/75
  1/118 [..............................] - ETA: 0s - loss: 0.1655 - accuracy: 0.9375 26/118 [=====>........................] - ETA: 0s - loss: 0.1957 - accuracy: 0.9435 51/118 [===========>..................] - ETA: 0s - loss: 0.2001 - accuracy: 0.9363 80/118 [===================>..........] - ETA: 0s - loss: 0.1977 - accuracy: 0.9387118/118 [==============================] - ETA: 0s - loss: 0.1866 - accuracy: 0.9421118/118 [==============================] - 0s 2ms/step - loss: 0.1866 - accuracy: 0.9421
Epoch 8/75
  1/118 [..............................] - ETA: 0s - loss: 0.1261 - accuracy: 0.9688 29/118 [======>.......................] - ETA: 0s - loss: 0.1842 - accuracy: 0.9375 54/118 [============>.................] - ETA: 0s - loss: 0.1828 - accuracy: 0.9398 79/118 [===================>..........] - ETA: 0s - loss: 0.1747 - accuracy: 0.9426105/118 [=========================>....] - ETA: 0s - loss: 0.1776 - accuracy: 0.9417118/118 [==============================] - 0s 2ms/step - loss: 0.1726 - accuracy: 0.9435
Epoch 9/75
  1/118 [..............................] - ETA: 0s - loss: 0.1083 - accuracy: 1.0000 25/118 [=====>........................] - ETA: 0s - loss: 0.1498 - accuracy: 0.9400 50/118 [===========>..................] - ETA: 0s - loss: 0.1544 - accuracy: 0.9400 78/118 [==================>...........] - ETA: 0s - loss: 0.1645 - accuracy: 0.9435104/118 [=========================>....] - ETA: 0s - loss: 0.1728 - accuracy: 0.9423118/118 [==============================] - 0s 2ms/step - loss: 0.1669 - accuracy: 0.9445
Epoch 10/75
  1/118 [..............................] - ETA: 0s - loss: 0.0770 - accuracy: 1.0000 24/118 [=====>........................] - ETA: 0s - loss: 0.1471 - accuracy: 0.9466 50/118 [===========>..................] - ETA: 0s - loss: 0.1608 - accuracy: 0.9469 80/118 [===================>..........] - ETA: 0s - loss: 0.1509 - accuracy: 0.9500107/118 [==========================>...] - ETA: 0s - loss: 0.1638 - accuracy: 0.9457118/118 [==============================] - 0s 2ms/step - loss: 0.1633 - accuracy: 0.9448
Epoch 11/75
  1/118 [..............................] - ETA: 0s - loss: 0.0672 - accuracy: 1.0000 27/118 [=====>........................] - ETA: 0s - loss: 0.1471 - accuracy: 0.9410 53/118 [============>.................] - ETA: 0s - loss: 0.1427 - accuracy: 0.9469 77/118 [==================>...........] - ETA: 0s - loss: 0.1433 - accuracy: 0.9468107/118 [==========================>...] - ETA: 0s - loss: 0.1475 - accuracy: 0.9480118/118 [==============================] - 0s 2ms/step - loss: 0.1577 - accuracy: 0.9461
Epoch 12/75
  1/118 [..............................] - ETA: 0s - loss: 0.0980 - accuracy: 0.9688 27/118 [=====>........................] - ETA: 0s - loss: 0.1516 - accuracy: 0.9433 55/118 [============>.................] - ETA: 0s - loss: 0.1644 - accuracy: 0.9460 82/118 [===================>..........] - ETA: 0s - loss: 0.1612 - accuracy: 0.9436108/118 [==========================>...] - ETA: 0s - loss: 0.1544 - accuracy: 0.9462118/118 [==============================] - 0s 2ms/step - loss: 0.1536 - accuracy: 0.9459
Epoch 13/75
  1/118 [..............................] - ETA: 0s - loss: 0.1470 - accuracy: 0.9688 30/118 [======>.......................] - ETA: 0s - loss: 0.1357 - accuracy: 0.9500 56/118 [=============>................] - ETA: 0s - loss: 0.1418 - accuracy: 0.9464 80/118 [===================>..........] - ETA: 0s - loss: 0.1461 - accuracy: 0.9457104/118 [=========================>....] - ETA: 0s - loss: 0.1498 - accuracy: 0.9450118/118 [==============================] - 0s 2ms/step - loss: 0.1497 - accuracy: 0.9472
Epoch 14/75
  1/118 [..............................] - ETA: 0s - loss: 0.1623 - accuracy: 0.9375 30/118 [======>.......................] - ETA: 0s - loss: 0.1499 - accuracy: 0.9448 59/118 [==============>...............] - ETA: 0s - loss: 0.1465 - accuracy: 0.9428 90/118 [=====================>........] - ETA: 0s - loss: 0.1567 - accuracy: 0.9434117/118 [============================>.] - ETA: 0s - loss: 0.1469 - accuracy: 0.9463118/118 [==============================] - 0s 2ms/step - loss: 0.1468 - accuracy: 0.9464
Epoch 15/75
  1/118 [..............................] - ETA: 0s - loss: 0.0778 - accuracy: 0.9688 27/118 [=====>........................] - ETA: 0s - loss: 0.1354 - accuracy: 0.9468 52/118 [============>.................] - ETA: 0s - loss: 0.1412 - accuracy: 0.9483 77/118 [==================>...........] - ETA: 0s - loss: 0.1437 - accuracy: 0.9436102/118 [========================>.....] - ETA: 0s - loss: 0.1411 - accuracy: 0.9467118/118 [==============================] - 0s 2ms/step - loss: 0.1447 - accuracy: 0.9464
Epoch 16/75
  1/118 [..............................] - ETA: 0s - loss: 0.1067 - accuracy: 0.9688 27/118 [=====>........................] - ETA: 0s - loss: 0.1501 - accuracy: 0.9491 52/118 [============>.................] - ETA: 0s - loss: 0.1552 - accuracy: 0.9501 76/118 [==================>...........] - ETA: 0s - loss: 0.1491 - accuracy: 0.9482103/118 [=========================>....] - ETA: 0s - loss: 0.1478 - accuracy: 0.9466118/118 [==============================] - 0s 2ms/step - loss: 0.1444 - accuracy: 0.9472
Epoch 17/75
  1/118 [..............................] - ETA: 0s - loss: 0.1268 - accuracy: 0.9688 28/118 [======>.......................] - ETA: 0s - loss: 0.1413 - accuracy: 0.9442 57/118 [=============>................] - ETA: 0s - loss: 0.1434 - accuracy: 0.9485 84/118 [====================>.........] - ETA: 0s - loss: 0.1451 - accuracy: 0.9487112/118 [===========================>..] - ETA: 0s - loss: 0.1439 - accuracy: 0.9492118/118 [==============================] - 0s 2ms/step - loss: 0.1448 - accuracy: 0.9475
Epoch 18/75
  1/118 [..............................] - ETA: 0s - loss: 0.1307 - accuracy: 0.9688 26/118 [=====>........................] - ETA: 0s - loss: 0.1380 - accuracy: 0.9567 52/118 [============>.................] - ETA: 0s - loss: 0.1480 - accuracy: 0.9525 78/118 [==================>...........] - ETA: 0s - loss: 0.1481 - accuracy: 0.9487110/118 [==========================>...] - ETA: 0s - loss: 0.1444 - accuracy: 0.9489118/118 [==============================] - 0s 2ms/step - loss: 0.1449 - accuracy: 0.9475
Epoch 19/75
  1/118 [..............................] - ETA: 0s - loss: 0.0750 - accuracy: 1.0000 28/118 [======>.......................] - ETA: 0s - loss: 0.1308 - accuracy: 0.9531 54/118 [============>.................] - ETA: 0s - loss: 0.1351 - accuracy: 0.9537 82/118 [===================>..........] - ETA: 0s - loss: 0.1325 - accuracy: 0.9493112/118 [===========================>..] - ETA: 0s - loss: 0.1418 - accuracy: 0.9478118/118 [==============================] - 0s 2ms/step - loss: 0.1422 - accuracy: 0.9475
Epoch 20/75
  1/118 [..............................] - ETA: 0s - loss: 0.1680 - accuracy: 0.9062 28/118 [======>.......................] - ETA: 0s - loss: 0.1555 - accuracy: 0.9408 52/118 [============>.................] - ETA: 0s - loss: 0.1421 - accuracy: 0.9435 78/118 [==================>...........] - ETA: 0s - loss: 0.1532 - accuracy: 0.9451106/118 [=========================>....] - ETA: 0s - loss: 0.1426 - accuracy: 0.9484118/118 [==============================] - 0s 2ms/step - loss: 0.1411 - accuracy: 0.9485
Epoch 21/75
  1/118 [..............................] - ETA: 0s - loss: 0.1966 - accuracy: 0.9688 29/118 [======>.......................] - ETA: 0s - loss: 0.1377 - accuracy: 0.9440 58/118 [=============>................] - ETA: 0s - loss: 0.1404 - accuracy: 0.9445 85/118 [====================>.........] - ETA: 0s - loss: 0.1399 - accuracy: 0.9460112/118 [===========================>..] - ETA: 0s - loss: 0.1412 - accuracy: 0.9487118/118 [==============================] - 0s 2ms/step - loss: 0.1408 - accuracy: 0.9491
Epoch 22/75
  1/118 [..............................] - ETA: 0s - loss: 0.1022 - accuracy: 0.9688 25/118 [=====>........................] - ETA: 0s - loss: 0.1187 - accuracy: 0.9513 49/118 [===========>..................] - ETA: 0s - loss: 0.1459 - accuracy: 0.9503 73/118 [=================>............] - ETA: 0s - loss: 0.1529 - accuracy: 0.9482103/118 [=========================>....] - ETA: 0s - loss: 0.1432 - accuracy: 0.9508118/118 [==============================] - 0s 2ms/step - loss: 0.1422 - accuracy: 0.9493
Epoch 23/75
  1/118 [..............................] - ETA: 0s - loss: 0.1114 - accuracy: 0.9688 27/118 [=====>........................] - ETA: 0s - loss: 0.1341 - accuracy: 0.9491 54/118 [============>.................] - ETA: 0s - loss: 0.1404 - accuracy: 0.9479 79/118 [===================>..........] - ETA: 0s - loss: 0.1306 - accuracy: 0.9517109/118 [==========================>...] - ETA: 0s - loss: 0.1397 - accuracy: 0.9493118/118 [==============================] - 0s 2ms/step - loss: 0.1392 - accuracy: 0.9483
Epoch 24/75
  1/118 [..............................] - ETA: 0s - loss: 0.1136 - accuracy: 0.9688 33/118 [=======>......................] - ETA: 0s - loss: 0.1338 - accuracy: 0.9508 59/118 [==============>...............] - ETA: 0s - loss: 0.1403 - accuracy: 0.9502 85/118 [====================>.........] - ETA: 0s - loss: 0.1377 - accuracy: 0.9504109/118 [==========================>...] - ETA: 0s - loss: 0.1379 - accuracy: 0.9495118/118 [==============================] - 0s 2ms/step - loss: 0.1409 - accuracy: 0.9480
Epoch 25/75
  1/118 [..............................] - ETA: 0s - loss: 0.1866 - accuracy: 0.9062 26/118 [=====>........................] - ETA: 0s - loss: 0.1474 - accuracy: 0.9399 51/118 [===========>..................] - ETA: 0s - loss: 0.1439 - accuracy: 0.9461 81/118 [===================>..........] - ETA: 0s - loss: 0.1362 - accuracy: 0.9491108/118 [==========================>...] - ETA: 0s - loss: 0.1396 - accuracy: 0.9470118/118 [==============================] - 0s 2ms/step - loss: 0.1394 - accuracy: 0.9480
Epoch 26/75
  1/118 [..............................] - ETA: 0s - loss: 0.2027 - accuracy: 0.9062 29/118 [======>.......................] - ETA: 0s - loss: 0.1469 - accuracy: 0.9461 54/118 [============>.................] - ETA: 0s - loss: 0.1429 - accuracy: 0.9462 80/118 [===================>..........] - ETA: 0s - loss: 0.1377 - accuracy: 0.9496111/118 [===========================>..] - ETA: 0s - loss: 0.1359 - accuracy: 0.9513118/118 [==============================] - 0s 2ms/step - loss: 0.1360 - accuracy: 0.9504
Epoch 27/75
  1/118 [..............................] - ETA: 0s - loss: 0.0727 - accuracy: 1.0000 26/118 [=====>........................] - ETA: 0s - loss: 0.1250 - accuracy: 0.9531 51/118 [===========>..................] - ETA: 0s - loss: 0.1193 - accuracy: 0.9553 79/118 [===================>..........] - ETA: 0s - loss: 0.1281 - accuracy: 0.9529107/118 [==========================>...] - ETA: 0s - loss: 0.1318 - accuracy: 0.9509118/118 [==============================] - 0s 2ms/step - loss: 0.1338 - accuracy: 0.9509
Epoch 28/75
  1/118 [..............................] - ETA: 0s - loss: 0.2263 - accuracy: 0.9375 27/118 [=====>........................] - ETA: 0s - loss: 0.1172 - accuracy: 0.9618 55/118 [============>.................] - ETA: 0s - loss: 0.1322 - accuracy: 0.9494 82/118 [===================>..........] - ETA: 0s - loss: 0.1315 - accuracy: 0.9501108/118 [==========================>...] - ETA: 0s - loss: 0.1325 - accuracy: 0.9505118/118 [==============================] - 0s 2ms/step - loss: 0.1327 - accuracy: 0.9504
Epoch 29/75
  1/118 [..............................] - ETA: 0s - loss: 0.1796 - accuracy: 0.9062 24/118 [=====>........................] - ETA: 0s - loss: 0.1134 - accuracy: 0.9674 47/118 [==========>...................] - ETA: 0s - loss: 0.1271 - accuracy: 0.9574 74/118 [=================>............] - ETA: 0s - loss: 0.1328 - accuracy: 0.9527101/118 [========================>.....] - ETA: 0s - loss: 0.1294 - accuracy: 0.9514118/118 [==============================] - 0s 2ms/step - loss: 0.1322 - accuracy: 0.9504
Epoch 30/75
  1/118 [..............................] - ETA: 0s - loss: 0.2961 - accuracy: 0.9062 25/118 [=====>........................] - ETA: 0s - loss: 0.1373 - accuracy: 0.9500 51/118 [===========>..................] - ETA: 0s - loss: 0.1380 - accuracy: 0.9510 77/118 [==================>...........] - ETA: 0s - loss: 0.1303 - accuracy: 0.9537108/118 [==========================>...] - ETA: 0s - loss: 0.1331 - accuracy: 0.9514118/118 [==============================] - 0s 2ms/step - loss: 0.1316 - accuracy: 0.9517
Epoch 31/75
  1/118 [..............................] - ETA: 0s - loss: 0.1447 - accuracy: 0.9688 27/118 [=====>........................] - ETA: 0s - loss: 0.1352 - accuracy: 0.9572 55/118 [============>.................] - ETA: 0s - loss: 0.1308 - accuracy: 0.9557 82/118 [===================>..........] - ETA: 0s - loss: 0.1313 - accuracy: 0.9527106/118 [=========================>....] - ETA: 0s - loss: 0.1308 - accuracy: 0.9511118/118 [==============================] - 0s 2ms/step - loss: 0.1322 - accuracy: 0.9512
Epoch 32/75
  1/118 [..............................] - ETA: 0s - loss: 0.1087 - accuracy: 0.9375 29/118 [======>.......................] - ETA: 0s - loss: 0.1433 - accuracy: 0.9483 54/118 [============>.................] - ETA: 0s - loss: 0.1389 - accuracy: 0.9485 81/118 [===================>..........] - ETA: 0s - loss: 0.1363 - accuracy: 0.9510106/118 [=========================>....] - ETA: 0s - loss: 0.1315 - accuracy: 0.9508118/118 [==============================] - 0s 2ms/step - loss: 0.1311 - accuracy: 0.9512
Epoch 33/75
  1/118 [..............................] - ETA: 0s - loss: 0.1378 - accuracy: 0.9375 26/118 [=====>........................] - ETA: 0s - loss: 0.1275 - accuracy: 0.9543 56/118 [=============>................] - ETA: 0s - loss: 0.1293 - accuracy: 0.9537 87/118 [=====================>........] - ETA: 0s - loss: 0.1311 - accuracy: 0.9529114/118 [===========================>..] - ETA: 0s - loss: 0.1307 - accuracy: 0.9504118/118 [==============================] - 0s 2ms/step - loss: 0.1305 - accuracy: 0.9504
Epoch 34/75
  1/118 [..............................] - ETA: 0s - loss: 0.1202 - accuracy: 0.9062 27/118 [=====>........................] - ETA: 0s - loss: 0.1167 - accuracy: 0.9641 55/118 [============>.................] - ETA: 0s - loss: 0.1229 - accuracy: 0.9591 85/118 [====================>.........] - ETA: 0s - loss: 0.1259 - accuracy: 0.9529112/118 [===========================>..] - ETA: 0s - loss: 0.1316 - accuracy: 0.9506118/118 [==============================] - 0s 2ms/step - loss: 0.1305 - accuracy: 0.9507
Epoch 35/75
  1/118 [..............................] - ETA: 0s - loss: 0.1785 - accuracy: 0.9062 26/118 [=====>........................] - ETA: 0s - loss: 0.1369 - accuracy: 0.9459 52/118 [============>.................] - ETA: 0s - loss: 0.1287 - accuracy: 0.9501 80/118 [===================>..........] - ETA: 0s - loss: 0.1283 - accuracy: 0.9516109/118 [==========================>...] - ETA: 0s - loss: 0.1320 - accuracy: 0.9495118/118 [==============================] - 0s 2ms/step - loss: 0.1297 - accuracy: 0.9507
Epoch 36/75
  1/118 [..............................] - ETA: 0s - loss: 0.0676 - accuracy: 1.0000 33/118 [=======>......................] - ETA: 0s - loss: 0.1257 - accuracy: 0.9527 59/118 [==============>...............] - ETA: 0s - loss: 0.1275 - accuracy: 0.9502 85/118 [====================>.........] - ETA: 0s - loss: 0.1216 - accuracy: 0.9533112/118 [===========================>..] - ETA: 0s - loss: 0.1262 - accuracy: 0.9526118/118 [==============================] - 0s 2ms/step - loss: 0.1302 - accuracy: 0.9512
Epoch 37/75
  1/118 [..............................] - ETA: 0s - loss: 0.1336 - accuracy: 0.9688 28/118 [======>.......................] - ETA: 0s - loss: 0.1459 - accuracy: 0.9453 56/118 [=============>................] - ETA: 0s - loss: 0.1561 - accuracy: 0.9503 86/118 [====================>.........] - ETA: 0s - loss: 0.1452 - accuracy: 0.9513116/118 [============================>.] - ETA: 0s - loss: 0.1346 - accuracy: 0.9518118/118 [==============================] - 0s 2ms/step - loss: 0.1340 - accuracy: 0.9520
Epoch 38/75
  1/118 [..............................] - ETA: 0s - loss: 0.1997 - accuracy: 0.9062 27/118 [=====>........................] - ETA: 0s - loss: 0.1216 - accuracy: 0.9572 52/118 [============>.................] - ETA: 0s - loss: 0.1193 - accuracy: 0.9567 77/118 [==================>...........] - ETA: 0s - loss: 0.1246 - accuracy: 0.9558106/118 [=========================>....] - ETA: 0s - loss: 0.1281 - accuracy: 0.9528118/118 [==============================] - 0s 2ms/step - loss: 0.1292 - accuracy: 0.9517
Epoch 39/75
  1/118 [..............................] - ETA: 0s - loss: 0.0858 - accuracy: 1.0000 28/118 [======>.......................] - ETA: 0s - loss: 0.1332 - accuracy: 0.9542 54/118 [============>.................] - ETA: 0s - loss: 0.1269 - accuracy: 0.9583 79/118 [===================>..........] - ETA: 0s - loss: 0.1311 - accuracy: 0.9549109/118 [==========================>...] - ETA: 0s - loss: 0.1262 - accuracy: 0.9541118/118 [==============================] - 0s 2ms/step - loss: 0.1286 - accuracy: 0.9523
Epoch 40/75
  1/118 [..............................] - ETA: 0s - loss: 0.0955 - accuracy: 0.9688 29/118 [======>.......................] - ETA: 0s - loss: 0.1378 - accuracy: 0.9526 60/118 [==============>...............] - ETA: 0s - loss: 0.1325 - accuracy: 0.9510 88/118 [=====================>........] - ETA: 0s - loss: 0.1254 - accuracy: 0.9535117/118 [============================>.] - ETA: 0s - loss: 0.1299 - accuracy: 0.9522118/118 [==============================] - 0s 2ms/step - loss: 0.1302 - accuracy: 0.9520
Epoch 41/75
  1/118 [..............................] - ETA: 0s - loss: 0.0669 - accuracy: 1.0000 25/118 [=====>........................] - ETA: 0s - loss: 0.0998 - accuracy: 0.9650 51/118 [===========>..................] - ETA: 0s - loss: 0.1341 - accuracy: 0.9516 77/118 [==================>...........] - ETA: 0s - loss: 0.1381 - accuracy: 0.9493107/118 [==========================>...] - ETA: 0s - loss: 0.1328 - accuracy: 0.9501118/118 [==============================] - 0s 2ms/step - loss: 0.1282 - accuracy: 0.9525
Epoch 42/75
  1/118 [..............................] - ETA: 0s - loss: 0.0802 - accuracy: 0.9688 28/118 [======>.......................] - ETA: 0s - loss: 0.1392 - accuracy: 0.9542 53/118 [============>.................] - ETA: 0s - loss: 0.1447 - accuracy: 0.9481 79/118 [===================>..........] - ETA: 0s - loss: 0.1427 - accuracy: 0.9478105/118 [=========================>....] - ETA: 0s - loss: 0.1357 - accuracy: 0.9524118/118 [==============================] - 0s 2ms/step - loss: 0.1322 - accuracy: 0.9528
Epoch 43/75
  1/118 [..............................] - ETA: 0s - loss: 0.5791 - accuracy: 0.9375 26/118 [=====>........................] - ETA: 0s - loss: 0.1379 - accuracy: 0.9567 51/118 [===========>..................] - ETA: 0s - loss: 0.1460 - accuracy: 0.9485 78/118 [==================>...........] - ETA: 0s - loss: 0.1452 - accuracy: 0.9491107/118 [==========================>...] - ETA: 0s - loss: 0.1359 - accuracy: 0.9515118/118 [==============================] - 0s 2ms/step - loss: 0.1336 - accuracy: 0.9525
Epoch 44/75
  1/118 [..............................] - ETA: 0s - loss: 0.2220 - accuracy: 0.9062 29/118 [======>.......................] - ETA: 0s - loss: 0.1471 - accuracy: 0.9407 60/118 [==============>...............] - ETA: 0s - loss: 0.1289 - accuracy: 0.9531 85/118 [====================>.........] - ETA: 0s - loss: 0.1336 - accuracy: 0.9526110/118 [==========================>...] - ETA: 0s - loss: 0.1352 - accuracy: 0.9514118/118 [==============================] - 0s 2ms/step - loss: 0.1329 - accuracy: 0.9525
Epoch 45/75
  1/118 [..............................] - ETA: 0s - loss: 0.1225 - accuracy: 0.9062 27/118 [=====>........................] - ETA: 0s - loss: 0.1381 - accuracy: 0.9421 52/118 [============>.................] - ETA: 0s - loss: 0.1271 - accuracy: 0.9513 78/118 [==================>...........] - ETA: 0s - loss: 0.1174 - accuracy: 0.9543108/118 [==========================>...] - ETA: 0s - loss: 0.1333 - accuracy: 0.9523118/118 [==============================] - 0s 2ms/step - loss: 0.1327 - accuracy: 0.9525
Epoch 46/75
  1/118 [..............................] - ETA: 0s - loss: 0.1267 - accuracy: 0.9688 26/118 [=====>........................] - ETA: 0s - loss: 0.1220 - accuracy: 0.9543 55/118 [============>.................] - ETA: 0s - loss: 0.1237 - accuracy: 0.9540 81/118 [===================>..........] - ETA: 0s - loss: 0.1276 - accuracy: 0.9564107/118 [==========================>...] - ETA: 0s - loss: 0.1341 - accuracy: 0.9530118/118 [==============================] - 0s 2ms/step - loss: 0.1325 - accuracy: 0.9528
Epoch 47/75
  1/118 [..............................] - ETA: 0s - loss: 0.1280 - accuracy: 0.9688 27/118 [=====>........................] - ETA: 0s - loss: 0.1573 - accuracy: 0.9479 53/118 [============>.................] - ETA: 0s - loss: 0.1499 - accuracy: 0.9469 79/118 [===================>..........] - ETA: 0s - loss: 0.1447 - accuracy: 0.9478106/118 [=========================>....] - ETA: 0s - loss: 0.1368 - accuracy: 0.9511118/118 [==============================] - 0s 2ms/step - loss: 0.1325 - accuracy: 0.9528
Epoch 48/75
  1/118 [..............................] - ETA: 0s - loss: 0.0898 - accuracy: 0.9688 29/118 [======>.......................] - ETA: 0s - loss: 0.1349 - accuracy: 0.9547 56/118 [=============>................] - ETA: 0s - loss: 0.1323 - accuracy: 0.9548 82/118 [===================>..........] - ETA: 0s - loss: 0.1289 - accuracy: 0.9535111/118 [===========================>..] - ETA: 0s - loss: 0.1339 - accuracy: 0.9521118/118 [==============================] - 0s 2ms/step - loss: 0.1325 - accuracy: 0.9528
Epoch 49/75
  1/118 [..............................] - ETA: 0s - loss: 0.1643 - accuracy: 0.9375 25/118 [=====>........................] - ETA: 0s - loss: 0.1063 - accuracy: 0.9600 51/118 [===========>..................] - ETA: 0s - loss: 0.1317 - accuracy: 0.9516 76/118 [==================>...........] - ETA: 0s - loss: 0.1420 - accuracy: 0.9523110/118 [==========================>...] - ETA: 0s - loss: 0.1314 - accuracy: 0.9537118/118 [==============================] - 0s 2ms/step - loss: 0.1323 - accuracy: 0.9528
Epoch 50/75
  1/118 [..............................] - ETA: 0s - loss: 0.0320 - accuracy: 1.0000 26/118 [=====>........................] - ETA: 0s - loss: 0.1192 - accuracy: 0.9543 50/118 [===========>..................] - ETA: 0s - loss: 0.1220 - accuracy: 0.9531 76/118 [==================>...........] - ETA: 0s - loss: 0.1309 - accuracy: 0.9515106/118 [=========================>....] - ETA: 0s - loss: 0.1310 - accuracy: 0.9540118/118 [==============================] - 0s 2ms/step - loss: 0.1324 - accuracy: 0.9525
Epoch 51/75
  1/118 [..............................] - ETA: 0s - loss: 0.7068 - accuracy: 0.8750 32/118 [=======>......................] - ETA: 0s - loss: 0.1477 - accuracy: 0.9551 63/118 [===============>..............] - ETA: 0s - loss: 0.1445 - accuracy: 0.9539 88/118 [=====================>........] - ETA: 0s - loss: 0.1379 - accuracy: 0.9528118/118 [==============================] - ETA: 0s - loss: 0.1322 - accuracy: 0.9525118/118 [==============================] - 0s 2ms/step - loss: 0.1322 - accuracy: 0.9525
Epoch 52/75
  1/118 [..............................] - ETA: 0s - loss: 0.1003 - accuracy: 0.9375 31/118 [======>.......................] - ETA: 0s - loss: 0.1376 - accuracy: 0.9546 54/118 [============>.................] - ETA: 0s - loss: 0.1209 - accuracy: 0.9549 81/118 [===================>..........] - ETA: 0s - loss: 0.1299 - accuracy: 0.9552107/118 [==========================>...] - ETA: 0s - loss: 0.1312 - accuracy: 0.9541118/118 [==============================] - 0s 2ms/step - loss: 0.1323 - accuracy: 0.9531
Epoch 53/75
  1/118 [..............................] - ETA: 0s - loss: 0.0580 - accuracy: 1.0000 26/118 [=====>........................] - ETA: 0s - loss: 0.1292 - accuracy: 0.9531 52/118 [============>.................] - ETA: 0s - loss: 0.1245 - accuracy: 0.9579 78/118 [==================>...........] - ETA: 0s - loss: 0.1211 - accuracy: 0.9567109/118 [==========================>...] - ETA: 0s - loss: 0.1314 - accuracy: 0.9527118/118 [==============================] - 0s 2ms/step - loss: 0.1323 - accuracy: 0.9528
Epoch 54/75
  1/118 [..............................] - ETA: 0s - loss: 0.0555 - accuracy: 0.9688 26/118 [=====>........................] - ETA: 0s - loss: 0.1523 - accuracy: 0.9495 51/118 [===========>..................] - ETA: 0s - loss: 0.1419 - accuracy: 0.9553 80/118 [===================>..........] - ETA: 0s - loss: 0.1408 - accuracy: 0.9516105/118 [=========================>....] - ETA: 0s - loss: 0.1366 - accuracy: 0.9518118/118 [==============================] - 0s 2ms/step - loss: 0.1326 - accuracy: 0.9523
Epoch 55/75
  1/118 [..............................] - ETA: 0s - loss: 0.0629 - accuracy: 1.0000 27/118 [=====>........................] - ETA: 0s - loss: 0.1377 - accuracy: 0.9560 52/118 [============>.................] - ETA: 0s - loss: 0.1308 - accuracy: 0.9525 77/118 [==================>...........] - ETA: 0s - loss: 0.1322 - accuracy: 0.9517101/118 [========================>.....] - ETA: 0s - loss: 0.1257 - accuracy: 0.9533118/118 [==============================] - 0s 2ms/step - loss: 0.1321 - accuracy: 0.9525
Epoch 56/75
  1/118 [..............................] - ETA: 0s - loss: 0.0864 - accuracy: 0.9688 28/118 [======>.......................] - ETA: 0s - loss: 0.1664 - accuracy: 0.9554 55/118 [============>.................] - ETA: 0s - loss: 0.1457 - accuracy: 0.9540 80/118 [===================>..........] - ETA: 0s - loss: 0.1381 - accuracy: 0.9543106/118 [=========================>....] - ETA: 0s - loss: 0.1349 - accuracy: 0.9525118/118 [==============================] - 0s 2ms/step - loss: 0.1320 - accuracy: 0.9531
Epoch 57/75
  1/118 [..............................] - ETA: 0s - loss: 0.0198 - accuracy: 1.0000 27/118 [=====>........................] - ETA: 0s - loss: 0.1667 - accuracy: 0.9444 53/118 [============>.................] - ETA: 0s - loss: 0.1555 - accuracy: 0.9446 80/118 [===================>..........] - ETA: 0s - loss: 0.1438 - accuracy: 0.9477111/118 [===========================>..] - ETA: 0s - loss: 0.1332 - accuracy: 0.9527118/118 [==============================] - 0s 2ms/step - loss: 0.1319 - accuracy: 0.9525
Epoch 58/75
  1/118 [..............................] - ETA: 0s - loss: 0.0416 - accuracy: 1.0000 27/118 [=====>........................] - ETA: 0s - loss: 0.1643 - accuracy: 0.9444 53/118 [============>.................] - ETA: 0s - loss: 0.1504 - accuracy: 0.9487 80/118 [===================>..........] - ETA: 0s - loss: 0.1413 - accuracy: 0.9492107/118 [==========================>...] - ETA: 0s - loss: 0.1374 - accuracy: 0.9504118/118 [==============================] - 0s 2ms/step - loss: 0.1329 - accuracy: 0.9523
Epoch 59/75
  1/118 [..............................] - ETA: 0s - loss: 0.0589 - accuracy: 0.9688 26/118 [=====>........................] - ETA: 0s - loss: 0.1461 - accuracy: 0.9531 51/118 [===========>..................] - ETA: 0s - loss: 0.1541 - accuracy: 0.9436 77/118 [==================>...........] - ETA: 0s - loss: 0.1377 - accuracy: 0.9468100/118 [========================>.....] - ETA: 0s - loss: 0.1360 - accuracy: 0.9500118/118 [==============================] - 0s 2ms/step - loss: 0.1298 - accuracy: 0.9517
Epoch 60/75
  1/118 [..............................] - ETA: 0s - loss: 0.1252 - accuracy: 0.9688 29/118 [======>.......................] - ETA: 0s - loss: 0.1615 - accuracy: 0.9397 56/118 [=============>................] - ETA: 0s - loss: 0.1319 - accuracy: 0.9509 89/118 [=====================>........] - ETA: 0s - loss: 0.1377 - accuracy: 0.9505113/118 [===========================>..] - ETA: 0s - loss: 0.1341 - accuracy: 0.9519118/118 [==============================] - 0s 2ms/step - loss: 0.1317 - accuracy: 0.9525
Epoch 61/75
  1/118 [..............................] - ETA: 0s - loss: 0.0913 - accuracy: 0.9375 26/118 [=====>........................] - ETA: 0s - loss: 0.1363 - accuracy: 0.9615 54/118 [============>.................] - ETA: 0s - loss: 0.1261 - accuracy: 0.9572 82/118 [===================>..........] - ETA: 0s - loss: 0.1275 - accuracy: 0.9546110/118 [==========================>...] - ETA: 0s - loss: 0.1323 - accuracy: 0.9531118/118 [==============================] - 0s 2ms/step - loss: 0.1318 - accuracy: 0.9525
Epoch 62/75
  1/118 [..............................] - ETA: 0s - loss: 0.1866 - accuracy: 0.8750 26/118 [=====>........................] - ETA: 0s - loss: 0.1297 - accuracy: 0.9519 49/118 [===========>..................] - ETA: 0s - loss: 0.1297 - accuracy: 0.9554 75/118 [==================>...........] - ETA: 0s - loss: 0.1334 - accuracy: 0.9533100/118 [========================>.....] - ETA: 0s - loss: 0.1300 - accuracy: 0.9519118/118 [==============================] - 0s 2ms/step - loss: 0.1329 - accuracy: 0.9525
Epoch 63/75
  1/118 [..............................] - ETA: 0s - loss: 0.0928 - accuracy: 0.9375 32/118 [=======>......................] - ETA: 0s - loss: 0.1124 - accuracy: 0.9600 59/118 [==============>...............] - ETA: 0s - loss: 0.1319 - accuracy: 0.9513 85/118 [====================>.........] - ETA: 0s - loss: 0.1274 - accuracy: 0.9526110/118 [==========================>...] - ETA: 0s - loss: 0.1266 - accuracy: 0.9528118/118 [==============================] - 0s 2ms/step - loss: 0.1319 - accuracy: 0.9525
Epoch 64/75
  1/118 [..............................] - ETA: 0s - loss: 0.0721 - accuracy: 0.9688 29/118 [======>.......................] - ETA: 0s - loss: 0.1179 - accuracy: 0.9547 58/118 [=============>................] - ETA: 0s - loss: 0.1329 - accuracy: 0.9564 83/118 [====================>.........] - ETA: 0s - loss: 0.1246 - accuracy: 0.9575109/118 [==========================>...] - ETA: 0s - loss: 0.1320 - accuracy: 0.9533118/118 [==============================] - 0s 2ms/step - loss: 0.1319 - accuracy: 0.9525
Epoch 65/75
  1/118 [..............................] - ETA: 0s - loss: 0.1910 - accuracy: 0.9375 27/118 [=====>........................] - ETA: 0s - loss: 0.1298 - accuracy: 0.9525 54/118 [============>.................] - ETA: 0s - loss: 0.1345 - accuracy: 0.9572 81/118 [===================>..........] - ETA: 0s - loss: 0.1301 - accuracy: 0.9556112/118 [===========================>..] - ETA: 0s - loss: 0.1328 - accuracy: 0.9528118/118 [==============================] - 0s 2ms/step - loss: 0.1344 - accuracy: 0.9525
Epoch 66/75
  1/118 [..............................] - ETA: 0s - loss: 0.0777 - accuracy: 0.9688 27/118 [=====>........................] - ETA: 0s - loss: 0.1085 - accuracy: 0.9572 52/118 [============>.................] - ETA: 0s - loss: 0.1255 - accuracy: 0.9489 79/118 [===================>..........] - ETA: 0s - loss: 0.1257 - accuracy: 0.9533108/118 [==========================>...] - ETA: 0s - loss: 0.1325 - accuracy: 0.9520118/118 [==============================] - 0s 2ms/step - loss: 0.1315 - accuracy: 0.9525
Epoch 67/75
  1/118 [..............................] - ETA: 0s - loss: 0.0819 - accuracy: 0.9688 32/118 [=======>......................] - ETA: 0s - loss: 0.1489 - accuracy: 0.9609 63/118 [===============>..............] - ETA: 0s - loss: 0.1387 - accuracy: 0.9519 90/118 [=====================>........] - ETA: 0s - loss: 0.1372 - accuracy: 0.9524118/118 [==============================] - 0s 2ms/step - loss: 0.1340 - accuracy: 0.9525
Epoch 68/75
  1/118 [..............................] - ETA: 0s - loss: 0.1111 - accuracy: 0.9375 27/118 [=====>........................] - ETA: 0s - loss: 0.1495 - accuracy: 0.9433 52/118 [============>.................] - ETA: 0s - loss: 0.1351 - accuracy: 0.9453 77/118 [==================>...........] - ETA: 0s - loss: 0.1234 - accuracy: 0.9521103/118 [=========================>....] - ETA: 0s - loss: 0.1325 - accuracy: 0.9502118/118 [==============================] - 0s 2ms/step - loss: 0.1288 - accuracy: 0.9517
Epoch 69/75
  1/118 [..............................] - ETA: 0s - loss: 0.0793 - accuracy: 0.9688 30/118 [======>.......................] - ETA: 0s - loss: 0.1273 - accuracy: 0.9573 55/118 [============>.................] - ETA: 0s - loss: 0.1277 - accuracy: 0.9494 81/118 [===================>..........] - ETA: 0s - loss: 0.1257 - accuracy: 0.9514108/118 [==========================>...] - ETA: 0s - loss: 0.1313 - accuracy: 0.9502118/118 [==============================] - 0s 2ms/step - loss: 0.1296 - accuracy: 0.9515
Epoch 70/75
  1/118 [..............................] - ETA: 0s - loss: 0.0468 - accuracy: 0.9688 25/118 [=====>........................] - ETA: 0s - loss: 0.1321 - accuracy: 0.9500 52/118 [============>.................] - ETA: 0s - loss: 0.1406 - accuracy: 0.9513 79/118 [===================>..........] - ETA: 0s - loss: 0.1317 - accuracy: 0.9529105/118 [=========================>....] - ETA: 0s - loss: 0.1283 - accuracy: 0.9530118/118 [==============================] - 0s 2ms/step - loss: 0.1291 - accuracy: 0.9525
Epoch 71/75
  1/118 [..............................] - ETA: 0s - loss: 0.0623 - accuracy: 1.0000 31/118 [======>.......................] - ETA: 0s - loss: 0.1380 - accuracy: 0.9536 61/118 [==============>...............] - ETA: 0s - loss: 0.1421 - accuracy: 0.9503 89/118 [=====================>........] - ETA: 0s - loss: 0.1388 - accuracy: 0.9515115/118 [============================>.] - ETA: 0s - loss: 0.1348 - accuracy: 0.9519118/118 [==============================] - 0s 2ms/step - loss: 0.1341 - accuracy: 0.9520
Epoch 72/75
  1/118 [..............................] - ETA: 0s - loss: 0.1155 - accuracy: 0.9688 25/118 [=====>........................] - ETA: 0s - loss: 0.1142 - accuracy: 0.9538 53/118 [============>.................] - ETA: 0s - loss: 0.1232 - accuracy: 0.9534 84/118 [====================>.........] - ETA: 0s - loss: 0.1255 - accuracy: 0.9539113/118 [===========================>..] - ETA: 0s - loss: 0.1368 - accuracy: 0.9499118/118 [==============================] - 0s 2ms/step - loss: 0.1376 - accuracy: 0.9501
Epoch 73/75
  1/118 [..............................] - ETA: 0s - loss: 0.0532 - accuracy: 1.0000 27/118 [=====>........................] - ETA: 0s - loss: 0.1299 - accuracy: 0.9595 53/118 [============>.................] - ETA: 0s - loss: 0.1284 - accuracy: 0.9540 77/118 [==================>...........] - ETA: 0s - loss: 0.1380 - accuracy: 0.9517104/118 [=========================>....] - ETA: 0s - loss: 0.1357 - accuracy: 0.9507118/118 [==============================] - 0s 2ms/step - loss: 0.1376 - accuracy: 0.9501
Epoch 74/75
  1/118 [..............................] - ETA: 0s - loss: 0.1751 - accuracy: 0.9688 30/118 [======>.......................] - ETA: 0s - loss: 0.1472 - accuracy: 0.9479 58/118 [=============>................] - ETA: 0s - loss: 0.1441 - accuracy: 0.9456 84/118 [====================>.........] - ETA: 0s - loss: 0.1415 - accuracy: 0.9479108/118 [==========================>...] - ETA: 0s - loss: 0.1396 - accuracy: 0.9491118/118 [==============================] - 0s 2ms/step - loss: 0.1371 - accuracy: 0.9504
Epoch 75/75
  1/118 [..............................] - ETA: 0s - loss: 0.1133 - accuracy: 1.0000 29/118 [======>.......................] - ETA: 0s - loss: 0.1286 - accuracy: 0.9558 59/118 [==============>...............] - ETA: 0s - loss: 0.1241 - accuracy: 0.9560 89/118 [=====================>........] - ETA: 0s - loss: 0.1337 - accuracy: 0.9508114/118 [===========================>..] - ETA: 0s - loss: 0.1370 - accuracy: 0.9507118/118 [==============================] - 0s 2ms/step - loss: 0.1367 - accuracy: 0.9507
#+end_example

** Evaluate the Model
:PROPERTIES:
:CUSTOM_ID: evaluate-the-model
:END:

#+begin_src python
model_loss, model_accuracy = nn_model.evaluate(X_test_scaled,y_test,verbose=2)

print(f"Loss: {model_loss}, Accuracy: {model_accuracy}")
#+end_src

#+RESULTS[009c452718b647972374329330a23931b9a86052]:
#+begin_example
40/40 - 0s - loss: 0.1348 - accuracy: 0.9528 - 187ms/epoch - 5ms/step
Loss: 0.13480015099048615, Accuracy: 0.9527999758720398
#+end_example

** Visualize the Results
:PROPERTIES:
:CUSTOM_ID: visualize-the-results
:END:

#+begin_src python :results file :wrap org
history_df = pd.DataFrame(fit_model.history, index=range(1,len(fit_model.history["loss"])+1))

file = "../resources/loss3.png"
fig, ax = plt.subplots(figsize=(6, 4))
ax.plot(history_df["loss"])
ax.set_title("Loss")
fig.savefig(file)
print(file)
#+end_src

#+RESULTS[c80686319f1800c6b69d15c2e5ae2d158efefbe7]:
#+begin_org
[[file:../resources/loss3.png]]
#+end_org

#+begin_src python :results file :wrap org
file = "../resources/accuracy3.png"
fig, ax = plt.subplots(figsize=(6, 4))
ax.plot(history_df["accuracy"])
ax.set_title("Accuracy")
fig.savefig(file)
print(file)
#+end_src

#+RESULTS[35a90bf017e3363d4c022e4b2f1b7c5ec008365e]:
#+begin_org
[[file:../resources/accuracy3.png]]
#+end_org

** Re-training the Model

We can re-train the model with less epochs.

#+begin_src python
nn_model.compile(loss="binary_crossentropy", optimizer="adam", metrics=["accuracy"])

fit_model = nn_model.fit(X_train_scaled, y_train, epochs=50)

history_df = pd.DataFrame(fit_model.history, index=range(1,len(fit_model.history["loss"])+1))
#+end_src

#+RESULTS[e592efd0edd21c0af3210f457b9fa961b6e52c9d]:
#+begin_example
Epoch 1/50
  1/118 [..............................] - ETA: 1:05 - loss: 0.2180 - accuracy: 0.8438 30/118 [======>.......................] - ETA: 0s - loss: 0.1233 - accuracy: 0.9396   64/118 [===============>..............] - ETA: 0s - loss: 0.1188 - accuracy: 0.9512102/118 [========================>.....] - ETA: 0s - loss: 0.1269 - accuracy: 0.9519118/118 [==============================] - 1s 1ms/step - loss: 0.1319 - accuracy: 0.9512
Epoch 2/50
  1/118 [..............................] - ETA: 0s - loss: 0.1972 - accuracy: 0.9062 33/118 [=======>......................] - ETA: 0s - loss: 0.1121 - accuracy: 0.9555 59/118 [==============>...............] - ETA: 0s - loss: 0.1298 - accuracy: 0.9507 87/118 [=====================>........] - ETA: 0s - loss: 0.1311 - accuracy: 0.9494118/118 [==============================] - ETA: 0s - loss: 0.1292 - accuracy: 0.9520118/118 [==============================] - 0s 2ms/step - loss: 0.1292 - accuracy: 0.9520
Epoch 3/50
  1/118 [..............................] - ETA: 0s - loss: 0.0865 - accuracy: 0.9688 30/118 [======>.......................] - ETA: 0s - loss: 0.1234 - accuracy: 0.9500 60/118 [==============>...............] - ETA: 0s - loss: 0.1314 - accuracy: 0.9474 90/118 [=====================>........] - ETA: 0s - loss: 0.1226 - accuracy: 0.9514118/118 [==============================] - 0s 2ms/step - loss: 0.1287 - accuracy: 0.9525
Epoch 4/50
  1/118 [..............................] - ETA: 0s - loss: 0.0899 - accuracy: 0.9688 30/118 [======>.......................] - ETA: 0s - loss: 0.1370 - accuracy: 0.9510 58/118 [=============>................] - ETA: 0s - loss: 0.1391 - accuracy: 0.9510 88/118 [=====================>........] - ETA: 0s - loss: 0.1335 - accuracy: 0.9524117/118 [============================>.] - ETA: 0s - loss: 0.1313 - accuracy: 0.9527118/118 [==============================] - 0s 2ms/step - loss: 0.1315 - accuracy: 0.9525
Epoch 5/50
  1/118 [..............................] - ETA: 0s - loss: 0.0756 - accuracy: 0.9375 32/118 [=======>......................] - ETA: 0s - loss: 0.1379 - accuracy: 0.9443 63/118 [===============>..............] - ETA: 0s - loss: 0.1238 - accuracy: 0.9514 93/118 [======================>.......] - ETA: 0s - loss: 0.1206 - accuracy: 0.9523118/118 [==============================] - 0s 2ms/step - loss: 0.1289 - accuracy: 0.9528
Epoch 6/50
  1/118 [..............................] - ETA: 0s - loss: 0.1585 - accuracy: 0.9375 33/118 [=======>......................] - ETA: 0s - loss: 0.1216 - accuracy: 0.9545 64/118 [===============>..............] - ETA: 0s - loss: 0.1192 - accuracy: 0.9585 94/118 [======================>.......] - ETA: 0s - loss: 0.1222 - accuracy: 0.9571118/118 [==============================] - 0s 2ms/step - loss: 0.1313 - accuracy: 0.9523
Epoch 7/50
  1/118 [..............................] - ETA: 0s - loss: 0.1854 - accuracy: 0.9375 31/118 [======>.......................] - ETA: 0s - loss: 0.1112 - accuracy: 0.9617 63/118 [===============>..............] - ETA: 0s - loss: 0.1303 - accuracy: 0.9563 92/118 [======================>.......] - ETA: 0s - loss: 0.1238 - accuracy: 0.9575118/118 [==============================] - 0s 2ms/step - loss: 0.1293 - accuracy: 0.9520
Epoch 8/50
  1/118 [..............................] - ETA: 0s - loss: 0.0723 - accuracy: 1.0000 31/118 [======>.......................] - ETA: 0s - loss: 0.1296 - accuracy: 0.9506 61/118 [==============>...............] - ETA: 0s - loss: 0.1329 - accuracy: 0.9518 88/118 [=====================>........] - ETA: 0s - loss: 0.1332 - accuracy: 0.9531112/118 [===========================>..] - ETA: 0s - loss: 0.1283 - accuracy: 0.9542118/118 [==============================] - 0s 2ms/step - loss: 0.1292 - accuracy: 0.9528
Epoch 9/50
  1/118 [..............................] - ETA: 0s - loss: 0.1057 - accuracy: 0.9688 24/118 [=====>........................] - ETA: 0s - loss: 0.1331 - accuracy: 0.9570 51/118 [===========>..................] - ETA: 0s - loss: 0.1303 - accuracy: 0.9540 79/118 [===================>..........] - ETA: 0s - loss: 0.1334 - accuracy: 0.9517113/118 [===========================>..] - ETA: 0s - loss: 0.1328 - accuracy: 0.9513118/118 [==============================] - 0s 2ms/step - loss: 0.1301 - accuracy: 0.9523
Epoch 10/50
  1/118 [..............................] - ETA: 0s - loss: 0.1526 - accuracy: 0.9688 32/118 [=======>......................] - ETA: 0s - loss: 0.1513 - accuracy: 0.9590 59/118 [==============>...............] - ETA: 0s - loss: 0.1432 - accuracy: 0.9513 86/118 [====================>.........] - ETA: 0s - loss: 0.1354 - accuracy: 0.9528117/118 [============================>.] - ETA: 0s - loss: 0.1312 - accuracy: 0.9533118/118 [==============================] - 0s 2ms/step - loss: 0.1312 - accuracy: 0.9531
Epoch 11/50
  1/118 [..............................] - ETA: 0s - loss: 0.0476 - accuracy: 1.0000 28/118 [======>.......................] - ETA: 0s - loss: 0.1232 - accuracy: 0.9520 57/118 [=============>................] - ETA: 0s - loss: 0.1306 - accuracy: 0.9507 90/118 [=====================>........] - ETA: 0s - loss: 0.1309 - accuracy: 0.9528116/118 [============================>.] - ETA: 0s - loss: 0.1291 - accuracy: 0.9515118/118 [==============================] - 0s 2ms/step - loss: 0.1286 - accuracy: 0.9515
Epoch 12/50
  1/118 [..............................] - ETA: 0s - loss: 0.4479 - accuracy: 0.8750 28/118 [======>.......................] - ETA: 0s - loss: 0.1464 - accuracy: 0.9420 51/118 [===========>..................] - ETA: 0s - loss: 0.1281 - accuracy: 0.9522 75/118 [==================>...........] - ETA: 0s - loss: 0.1287 - accuracy: 0.9525101/118 [========================>.....] - ETA: 0s - loss: 0.1303 - accuracy: 0.9502118/118 [==============================] - 0s 2ms/step - loss: 0.1279 - accuracy: 0.9517
Epoch 13/50
  1/118 [..............................] - ETA: 0s - loss: 0.2777 - accuracy: 0.9062 27/118 [=====>........................] - ETA: 0s - loss: 0.1440 - accuracy: 0.9537 49/118 [===========>..................] - ETA: 0s - loss: 0.1431 - accuracy: 0.9522 73/118 [=================>............] - ETA: 0s - loss: 0.1357 - accuracy: 0.9538 98/118 [=======================>......] - ETA: 0s - loss: 0.1291 - accuracy: 0.9528118/118 [==============================] - 0s 2ms/step - loss: 0.1287 - accuracy: 0.9528
Epoch 14/50
  1/118 [..............................] - ETA: 0s - loss: 0.1065 - accuracy: 0.9375 23/118 [====>.........................] - ETA: 0s - loss: 0.1425 - accuracy: 0.9524 46/118 [==========>...................] - ETA: 0s - loss: 0.1371 - accuracy: 0.9490 70/118 [================>.............] - ETA: 0s - loss: 0.1401 - accuracy: 0.9496 97/118 [=======================>......] - ETA: 0s - loss: 0.1331 - accuracy: 0.9520118/118 [==============================] - 0s 2ms/step - loss: 0.1285 - accuracy: 0.9523
Epoch 15/50
  1/118 [..............................] - ETA: 0s - loss: 0.0826 - accuracy: 0.9688 26/118 [=====>........................] - ETA: 0s - loss: 0.1380 - accuracy: 0.9519 52/118 [============>.................] - ETA: 0s - loss: 0.1205 - accuracy: 0.9549 77/118 [==================>...........] - ETA: 0s - loss: 0.1220 - accuracy: 0.9554101/118 [========================>.....] - ETA: 0s - loss: 0.1278 - accuracy: 0.9533118/118 [==============================] - 0s 2ms/step - loss: 0.1285 - accuracy: 0.9523
Epoch 16/50
  1/118 [..............................] - ETA: 0s - loss: 0.1041 - accuracy: 0.9375 31/118 [======>.......................] - ETA: 0s - loss: 0.1189 - accuracy: 0.9526 58/118 [=============>................] - ETA: 0s - loss: 0.1484 - accuracy: 0.9477 83/118 [====================>.........] - ETA: 0s - loss: 0.1353 - accuracy: 0.9522108/118 [==========================>...] - ETA: 0s - loss: 0.1282 - accuracy: 0.9534118/118 [==============================] - 0s 2ms/step - loss: 0.1283 - accuracy: 0.9528
Epoch 17/50
  1/118 [..............................] - ETA: 0s - loss: 0.0952 - accuracy: 0.9375 26/118 [=====>........................] - ETA: 0s - loss: 0.1240 - accuracy: 0.9507 54/118 [============>.................] - ETA: 0s - loss: 0.1185 - accuracy: 0.9525 78/118 [==================>...........] - ETA: 0s - loss: 0.1420 - accuracy: 0.9471103/118 [=========================>....] - ETA: 0s - loss: 0.1330 - accuracy: 0.9518118/118 [==============================] - 0s 2ms/step - loss: 0.1309 - accuracy: 0.9520
Epoch 18/50
  1/118 [..............................] - ETA: 0s - loss: 0.1290 - accuracy: 0.9062 25/118 [=====>........................] - ETA: 0s - loss: 0.1244 - accuracy: 0.9438 47/118 [==========>...................] - ETA: 0s - loss: 0.1412 - accuracy: 0.9461 73/118 [=================>............] - ETA: 0s - loss: 0.1309 - accuracy: 0.9512100/118 [========================>.....] - ETA: 0s - loss: 0.1358 - accuracy: 0.9500118/118 [==============================] - 0s 2ms/step - loss: 0.1306 - accuracy: 0.9520
Epoch 19/50
  1/118 [..............................] - ETA: 0s - loss: 0.1673 - accuracy: 0.8750 24/118 [=====>........................] - ETA: 0s - loss: 0.1546 - accuracy: 0.9518 48/118 [===========>..................] - ETA: 0s - loss: 0.1414 - accuracy: 0.9512 73/118 [=================>............] - ETA: 0s - loss: 0.1321 - accuracy: 0.9542100/118 [========================>.....] - ETA: 0s - loss: 0.1286 - accuracy: 0.9528118/118 [==============================] - 0s 2ms/step - loss: 0.1286 - accuracy: 0.9520
Epoch 20/50
  1/118 [..............................] - ETA: 0s - loss: 0.1100 - accuracy: 0.9375 27/118 [=====>........................] - ETA: 0s - loss: 0.1312 - accuracy: 0.9479 52/118 [============>.................] - ETA: 0s - loss: 0.1295 - accuracy: 0.9507 76/118 [==================>...........] - ETA: 0s - loss: 0.1332 - accuracy: 0.9486 99/118 [========================>.....] - ETA: 0s - loss: 0.1290 - accuracy: 0.9504118/118 [==============================] - 0s 2ms/step - loss: 0.1284 - accuracy: 0.9523
Epoch 21/50
  1/118 [..............................] - ETA: 0s - loss: 0.0881 - accuracy: 0.9688 25/118 [=====>........................] - ETA: 0s - loss: 0.1271 - accuracy: 0.9413 51/118 [===========>..................] - ETA: 0s - loss: 0.1150 - accuracy: 0.9498 76/118 [==================>...........] - ETA: 0s - loss: 0.1195 - accuracy: 0.9527 99/118 [========================>.....] - ETA: 0s - loss: 0.1235 - accuracy: 0.9527118/118 [==============================] - 0s 2ms/step - loss: 0.1285 - accuracy: 0.9523
Epoch 22/50
  1/118 [..............................] - ETA: 0s - loss: 0.0351 - accuracy: 1.0000 27/118 [=====>........................] - ETA: 0s - loss: 0.1136 - accuracy: 0.9595 56/118 [=============>................] - ETA: 0s - loss: 0.1253 - accuracy: 0.9531 86/118 [====================>.........] - ETA: 0s - loss: 0.1188 - accuracy: 0.9557112/118 [===========================>..] - ETA: 0s - loss: 0.1269 - accuracy: 0.9528118/118 [==============================] - 0s 2ms/step - loss: 0.1283 - accuracy: 0.9523
Epoch 23/50
  1/118 [..............................] - ETA: 0s - loss: 0.1508 - accuracy: 0.9375 28/118 [======>.......................] - ETA: 0s - loss: 0.1177 - accuracy: 0.9554 59/118 [==============>...............] - ETA: 0s - loss: 0.1232 - accuracy: 0.9555 90/118 [=====================>........] - ETA: 0s - loss: 0.1305 - accuracy: 0.9542118/118 [==============================] - ETA: 0s - loss: 0.1283 - accuracy: 0.9523118/118 [==============================] - 0s 2ms/step - loss: 0.1283 - accuracy: 0.9523
Epoch 24/50
  1/118 [..............................] - ETA: 0s - loss: 0.5627 - accuracy: 0.9375 33/118 [=======>......................] - ETA: 0s - loss: 0.1292 - accuracy: 0.9536 62/118 [==============>...............] - ETA: 0s - loss: 0.1381 - accuracy: 0.9531 90/118 [=====================>........] - ETA: 0s - loss: 0.1382 - accuracy: 0.9500118/118 [==============================] - 0s 2ms/step - loss: 0.1285 - accuracy: 0.9525
Epoch 25/50
  1/118 [..............................] - ETA: 0s - loss: 0.0438 - accuracy: 0.9688 32/118 [=======>......................] - ETA: 0s - loss: 0.1311 - accuracy: 0.9531 63/118 [===============>..............] - ETA: 0s - loss: 0.1248 - accuracy: 0.9554 93/118 [======================>.......] - ETA: 0s - loss: 0.1307 - accuracy: 0.9513118/118 [==============================] - 0s 2ms/step - loss: 0.1283 - accuracy: 0.9520
Epoch 26/50
  1/118 [..............................] - ETA: 0s - loss: 0.1526 - accuracy: 0.9688 29/118 [======>.......................] - ETA: 0s - loss: 0.1413 - accuracy: 0.9461 59/118 [==============>...............] - ETA: 0s - loss: 0.1454 - accuracy: 0.9470 93/118 [======================>.......] - ETA: 0s - loss: 0.1308 - accuracy: 0.9516118/118 [==============================] - 0s 2ms/step - loss: 0.1286 - accuracy: 0.9528
Epoch 27/50
  1/118 [..............................] - ETA: 0s - loss: 0.0913 - accuracy: 0.9688 30/118 [======>.......................] - ETA: 0s - loss: 0.1202 - accuracy: 0.9531 60/118 [==============>...............] - ETA: 0s - loss: 0.1246 - accuracy: 0.9563 94/118 [======================>.......] - ETA: 0s - loss: 0.1327 - accuracy: 0.9521118/118 [==============================] - 0s 2ms/step - loss: 0.1311 - accuracy: 0.9520
Epoch 28/50
  1/118 [..............................] - ETA: 0s - loss: 0.0759 - accuracy: 0.9688 33/118 [=======>......................] - ETA: 0s - loss: 0.1527 - accuracy: 0.9517 64/118 [===============>..............] - ETA: 0s - loss: 0.1390 - accuracy: 0.9521 95/118 [=======================>......] - ETA: 0s - loss: 0.1344 - accuracy: 0.9510118/118 [==============================] - 0s 2ms/step - loss: 0.1283 - accuracy: 0.9517
Epoch 29/50
  1/118 [..............................] - ETA: 0s - loss: 0.1110 - accuracy: 0.9375 32/118 [=======>......................] - ETA: 0s - loss: 0.1237 - accuracy: 0.9551 62/118 [==============>...............] - ETA: 0s - loss: 0.1344 - accuracy: 0.9496 95/118 [=======================>......] - ETA: 0s - loss: 0.1247 - accuracy: 0.9536118/118 [==============================] - 0s 2ms/step - loss: 0.1283 - accuracy: 0.9523
Epoch 30/50
  1/118 [..............................] - ETA: 0s - loss: 0.0871 - accuracy: 0.9688 31/118 [======>.......................] - ETA: 0s - loss: 0.1377 - accuracy: 0.9536 59/118 [==============>...............] - ETA: 0s - loss: 0.1385 - accuracy: 0.9523 90/118 [=====================>........] - ETA: 0s - loss: 0.1299 - accuracy: 0.9538118/118 [==============================] - 0s 2ms/step - loss: 0.1309 - accuracy: 0.9523
Epoch 31/50
  1/118 [..............................] - ETA: 0s - loss: 0.0514 - accuracy: 0.9688 31/118 [======>.......................] - ETA: 0s - loss: 0.1368 - accuracy: 0.9516 62/118 [==============>...............] - ETA: 0s - loss: 0.1333 - accuracy: 0.9516 96/118 [=======================>......] - ETA: 0s - loss: 0.1307 - accuracy: 0.9525118/118 [==============================] - 0s 2ms/step - loss: 0.1290 - accuracy: 0.9523
Epoch 32/50
  1/118 [..............................] - ETA: 0s - loss: 0.0669 - accuracy: 0.9375 34/118 [=======>......................] - ETA: 0s - loss: 0.1183 - accuracy: 0.9504 65/118 [===============>..............] - ETA: 0s - loss: 0.1198 - accuracy: 0.9500 93/118 [======================>.......] - ETA: 0s - loss: 0.1234 - accuracy: 0.9516118/118 [==============================] - 0s 2ms/step - loss: 0.1283 - accuracy: 0.9517
Epoch 33/50
  1/118 [..............................] - ETA: 0s - loss: 0.0669 - accuracy: 0.9688 31/118 [======>.......................] - ETA: 0s - loss: 0.0891 - accuracy: 0.9688 63/118 [===============>..............] - ETA: 0s - loss: 0.1360 - accuracy: 0.9484 94/118 [======================>.......] - ETA: 0s - loss: 0.1402 - accuracy: 0.9458118/118 [==============================] - 0s 2ms/step - loss: 0.1316 - accuracy: 0.9499
Epoch 34/50
  1/118 [..............................] - ETA: 0s - loss: 0.2117 - accuracy: 0.9062 31/118 [======>.......................] - ETA: 0s - loss: 0.1342 - accuracy: 0.9536 61/118 [==============>...............] - ETA: 0s - loss: 0.1244 - accuracy: 0.9539 93/118 [======================>.......] - ETA: 0s - loss: 0.1307 - accuracy: 0.9503118/118 [==============================] - 0s 2ms/step - loss: 0.1273 - accuracy: 0.9512
Epoch 35/50
  1/118 [..............................] - ETA: 0s - loss: 0.0362 - accuracy: 1.0000 28/118 [======>.......................] - ETA: 0s - loss: 0.1164 - accuracy: 0.9576 55/118 [============>.................] - ETA: 0s - loss: 0.1413 - accuracy: 0.9455 81/118 [===================>..........] - ETA: 0s - loss: 0.1341 - accuracy: 0.9491107/118 [==========================>...] - ETA: 0s - loss: 0.1303 - accuracy: 0.9501118/118 [==============================] - 0s 2ms/step - loss: 0.1270 - accuracy: 0.9512
Epoch 36/50
  1/118 [..............................] - ETA: 0s - loss: 0.1991 - accuracy: 0.9688 27/118 [=====>........................] - ETA: 0s - loss: 0.1306 - accuracy: 0.9491 44/118 [==========>...................] - ETA: 0s - loss: 0.1211 - accuracy: 0.9517 55/118 [============>.................] - ETA: 0s - loss: 0.1182 - accuracy: 0.9528 69/118 [================>.............] - ETA: 0s - loss: 0.1195 - accuracy: 0.9547 86/118 [====================>.........] - ETA: 0s - loss: 0.1192 - accuracy: 0.9535104/118 [=========================>....] - ETA: 0s - loss: 0.1288 - accuracy: 0.9513118/118 [==============================] - 0s 3ms/step - loss: 0.1277 - accuracy: 0.9517
Epoch 37/50
  1/118 [..............................] - ETA: 0s - loss: 0.1217 - accuracy: 0.9375 20/118 [====>.........................] - ETA: 0s - loss: 0.1054 - accuracy: 0.9563 36/118 [========>.....................] - ETA: 0s - loss: 0.1179 - accuracy: 0.9540 52/118 [============>.................] - ETA: 0s - loss: 0.1177 - accuracy: 0.9543 68/118 [================>.............] - ETA: 0s - loss: 0.1157 - accuracy: 0.9554 85/118 [====================>.........] - ETA: 0s - loss: 0.1325 - accuracy: 0.9507106/118 [=========================>....] - ETA: 0s - loss: 0.1289 - accuracy: 0.9519118/118 [==============================] - 0s 3ms/step - loss: 0.1287 - accuracy: 0.9525
Epoch 38/50
  1/118 [..............................] - ETA: 0s - loss: 0.1041 - accuracy: 0.9375 25/118 [=====>........................] - ETA: 0s - loss: 0.1421 - accuracy: 0.9550 46/118 [==========>...................] - ETA: 0s - loss: 0.1208 - accuracy: 0.9599 68/118 [================>.............] - ETA: 0s - loss: 0.1275 - accuracy: 0.9545 90/118 [=====================>........] - ETA: 0s - loss: 0.1273 - accuracy: 0.9549114/118 [===========================>..] - ETA: 0s - loss: 0.1291 - accuracy: 0.9526118/118 [==============================] - 0s 2ms/step - loss: 0.1283 - accuracy: 0.9525
Epoch 39/50
  1/118 [..............................] - ETA: 0s - loss: 0.0864 - accuracy: 0.9688 25/118 [=====>........................] - ETA: 0s - loss: 0.1494 - accuracy: 0.9488 43/118 [=========>....................] - ETA: 0s - loss: 0.1312 - accuracy: 0.9528 61/118 [==============>...............] - ETA: 0s - loss: 0.1311 - accuracy: 0.9529 80/118 [===================>..........] - ETA: 0s - loss: 0.1252 - accuracy: 0.9547105/118 [=========================>....] - ETA: 0s - loss: 0.1288 - accuracy: 0.9533118/118 [==============================] - 0s 2ms/step - loss: 0.1281 - accuracy: 0.9525
Epoch 40/50
  1/118 [..............................] - ETA: 0s - loss: 0.0713 - accuracy: 0.9688 27/118 [=====>........................] - ETA: 0s - loss: 0.1173 - accuracy: 0.9479 53/118 [============>.................] - ETA: 0s - loss: 0.1275 - accuracy: 0.9505 77/118 [==================>...........] - ETA: 0s - loss: 0.1269 - accuracy: 0.9505 99/118 [========================>.....] - ETA: 0s - loss: 0.1227 - accuracy: 0.9520118/118 [==============================] - ETA: 0s - loss: 0.1283 - accuracy: 0.9525118/118 [==============================] - 0s 2ms/step - loss: 0.1283 - accuracy: 0.9525
Epoch 41/50
  1/118 [..............................] - ETA: 0s - loss: 0.2828 - accuracy: 0.8750 12/118 [==>...........................] - ETA: 0s - loss: 0.1405 - accuracy: 0.9271 30/118 [======>.......................] - ETA: 0s - loss: 0.1263 - accuracy: 0.9448 49/118 [===========>..................] - ETA: 0s - loss: 0.1297 - accuracy: 0.9496 68/118 [================>.............] - ETA: 0s - loss: 0.1325 - accuracy: 0.9481 87/118 [=====================>........] - ETA: 0s - loss: 0.1335 - accuracy: 0.9483107/118 [==========================>...] - ETA: 0s - loss: 0.1314 - accuracy: 0.9512118/118 [==============================] - 0s 3ms/step - loss: 0.1281 - accuracy: 0.9520
Epoch 42/50
  1/118 [..............................] - ETA: 0s - loss: 0.1852 - accuracy: 0.9375 28/118 [======>.......................] - ETA: 0s - loss: 0.1195 - accuracy: 0.9520 51/118 [===========>..................] - ETA: 0s - loss: 0.1271 - accuracy: 0.9528 73/118 [=================>............] - ETA: 0s - loss: 0.1251 - accuracy: 0.9499 98/118 [=======================>......] - ETA: 0s - loss: 0.1320 - accuracy: 0.9503118/118 [==============================] - 0s 2ms/step - loss: 0.1281 - accuracy: 0.9520
Epoch 43/50
  1/118 [..............................] - ETA: 0s - loss: 0.0584 - accuracy: 0.9688 29/118 [======>.......................] - ETA: 0s - loss: 0.1686 - accuracy: 0.9483 57/118 [=============>................] - ETA: 0s - loss: 0.1495 - accuracy: 0.9479 85/118 [====================>.........] - ETA: 0s - loss: 0.1311 - accuracy: 0.9522109/118 [==========================>...] - ETA: 0s - loss: 0.1298 - accuracy: 0.9518118/118 [==============================] - 0s 2ms/step - loss: 0.1283 - accuracy: 0.9525
Epoch 44/50
  1/118 [..............................] - ETA: 0s - loss: 0.2504 - accuracy: 0.9062 19/118 [===>..........................] - ETA: 0s - loss: 0.1309 - accuracy: 0.9474 41/118 [=========>....................] - ETA: 0s - loss: 0.1222 - accuracy: 0.9520 59/118 [==============>...............] - ETA: 0s - loss: 0.1170 - accuracy: 0.9544 80/118 [===================>..........] - ETA: 0s - loss: 0.1215 - accuracy: 0.9527 98/118 [=======================>......] - ETA: 0s - loss: 0.1262 - accuracy: 0.9509118/118 [==============================] - 0s 3ms/step - loss: 0.1285 - accuracy: 0.9520
Epoch 45/50
  1/118 [..............................] - ETA: 0s - loss: 0.2318 - accuracy: 0.9062 19/118 [===>..........................] - ETA: 0s - loss: 0.1242 - accuracy: 0.9490 39/118 [========>.....................] - ETA: 0s - loss: 0.1163 - accuracy: 0.9527 58/118 [=============>................] - ETA: 0s - loss: 0.1153 - accuracy: 0.9553 80/118 [===================>..........] - ETA: 0s - loss: 0.1343 - accuracy: 0.9500102/118 [========================>.....] - ETA: 0s - loss: 0.1341 - accuracy: 0.9491118/118 [==============================] - 0s 3ms/step - loss: 0.1304 - accuracy: 0.9509
Epoch 46/50
  1/118 [..............................] - ETA: 0s - loss: 0.0787 - accuracy: 0.9688 20/118 [====>.........................] - ETA: 0s - loss: 0.1241 - accuracy: 0.9531 39/118 [========>.....................] - ETA: 0s - loss: 0.1164 - accuracy: 0.9559 58/118 [=============>................] - ETA: 0s - loss: 0.1213 - accuracy: 0.9526 78/118 [==================>...........] - ETA: 0s - loss: 0.1217 - accuracy: 0.9523101/118 [========================>.....] - ETA: 0s - loss: 0.1327 - accuracy: 0.9517118/118 [==============================] - ETA: 0s - loss: 0.1283 - accuracy: 0.9523118/118 [==============================] - 0s 3ms/step - loss: 0.1283 - accuracy: 0.9523
Epoch 47/50
  1/118 [..............................] - ETA: 0s - loss: 0.0242 - accuracy: 1.0000 14/118 [==>...........................] - ETA: 0s - loss: 0.1008 - accuracy: 0.9665 30/118 [======>.......................] - ETA: 0s - loss: 0.1118 - accuracy: 0.9573 49/118 [===========>..................] - ETA: 0s - loss: 0.1251 - accuracy: 0.9509 69/118 [================>.............] - ETA: 0s - loss: 0.1214 - accuracy: 0.9515 84/118 [====================>.........] - ETA: 0s - loss: 0.1230 - accuracy: 0.9535105/118 [=========================>....] - ETA: 0s - loss: 0.1248 - accuracy: 0.9527112/118 [===========================>..] - ETA: 0s - loss: 0.1249 - accuracy: 0.9517118/118 [==============================] - 0s 3ms/step - loss: 0.1281 - accuracy: 0.9525
Epoch 48/50
  1/118 [..............................] - ETA: 0s - loss: 0.0845 - accuracy: 0.9688 29/118 [======>.......................] - ETA: 0s - loss: 0.1115 - accuracy: 0.9601 52/118 [============>.................] - ETA: 0s - loss: 0.1401 - accuracy: 0.9537 77/118 [==================>...........] - ETA: 0s - loss: 0.1278 - accuracy: 0.9554102/118 [========================>.....] - ETA: 0s - loss: 0.1276 - accuracy: 0.9534118/118 [==============================] - 0s 2ms/step - loss: 0.1282 - accuracy: 0.9525
Epoch 49/50
  1/118 [..............................] - ETA: 0s - loss: 0.1525 - accuracy: 0.9375 30/118 [======>.......................] - ETA: 0s - loss: 0.1456 - accuracy: 0.9417 57/118 [=============>................] - ETA: 0s - loss: 0.1220 - accuracy: 0.9507 83/118 [====================>.........] - ETA: 0s - loss: 0.1357 - accuracy: 0.9507110/118 [==========================>...] - ETA: 0s - loss: 0.1305 - accuracy: 0.9520118/118 [==============================] - 0s 2ms/step - loss: 0.1284 - accuracy: 0.9528
Epoch 50/50
  1/118 [..............................] - ETA: 0s - loss: 0.0843 - accuracy: 0.9688 28/118 [======>.......................] - ETA: 0s - loss: 0.1192 - accuracy: 0.9576 54/118 [============>.................] - ETA: 0s - loss: 0.1122 - accuracy: 0.9589 71/118 [=================>............] - ETA: 0s - loss: 0.1159 - accuracy: 0.9577 93/118 [======================>.......] - ETA: 0s - loss: 0.1305 - accuracy: 0.9513115/118 [============================>.] - ETA: 0s - loss: 0.1286 - accuracy: 0.9522118/118 [==============================] - 0s 2ms/step - loss: 0.1281 - accuracy: 0.9523
#+end_example

#+begin_src python
model_loss, model_accuracy = nn_model.evaluate(X_test_scaled,y_test,verbose=2)

print(f"Loss: {model_loss}, Accuracy: {model_accuracy}")
#+end_src

#+RESULTS[009c452718b647972374329330a23931b9a86052]:
#+begin_example
40/40 - 0s - loss: 0.1331 - accuracy: 0.9496 - 167ms/epoch - 4ms/step
Loss: 0.13306818902492523, Accuracy: 0.9495999813079834
#+end_example

The results aren't great because of the distribution of our data, if we go back to visualizing the dataset, we can see that the area in the middle is basically white noise.

#+attr_html: :width 500px
[[../resources/test2.png]]

* Encoding Data
:PROPERTIES:
:CUSTOM_ID: encoding-data
:END:

** Get Frequencies
:PROPERTIES:
:CUSTOM_ID: get-frequencies
:END:

#+begin_src python
import pandas as pd
import sklearn as skl
import matplotlib.pyplot as plt

ramen_df = pd.read_csv('../resources/ramen-ratings.csv')

country_counts = ramen_df.Country.value_counts()
print(country_counts)
#+end_src

#+RESULTS[00f503f0c01854593b74360d27982efb5712bb8d]:
#+begin_example
Japan            352
USA              323
South Korea      309
Taiwan           224
Thailand         191
China            169
Malaysia         156
Hong Kong        137
Indonesia        126
Singapore        109
Vietnam          108
UK                69
Philippines       47
Canada            41
India             31
Germany           27
Mexico            25
Australia         22
Netherlands       15
Myanmar           14
Nepal             14
Pakistan           9
Hungary            9
Bangladesh         7
Colombia           6
Brazil             5
Cambodia           5
Fiji               4
Holland            4
Poland             4
Finland            3
Sarawak            3
Sweden             3
Dubai              3
Ghana              2
Estonia            2
Nigeria            1
United States      1
Name: Country, dtype: int64
#+end_example

#+begin_src python
replace_countries = list(country_counts[country_counts < 100].index)

ramen_df["Country"] = ramen_df["Country"].map(lambda x: "Other" if x in replace_countries else x)

print(ramen_df.Country.value_counts())
#+end_src

#+RESULTS[77e3cb4556eba7a47a8a2bc277d8110f6b0fe67e]:
#+begin_example
Other          376
Japan          352
USA            323
South Korea    309
Taiwan         224
Thailand       191
China          169
Malaysia       156
Hong Kong      137
Indonesia      126
Singapore      109
Vietnam        108
Name: Country, dtype: int64
#+end_example

** One Hot Encoder
:PROPERTIES:
:CUSTOM_ID: one-hot-encoder
:END:

We are going to transpose the variables to 'binary' numerical data.

#+begin_src python
from sklearn.preprocessing import OneHotEncoder
enc = OneHotEncoder(sparse=False)

encode_df = pd.DataFrame(enc.fit_transform(ramen_df['Country'].values.reshape(-1,1)))

encode_df.columns = enc.get_feature_names_out(['Country'])

print(encode_df.head())
#+end_src

#+RESULTS[b96b842de91106ede525691738e9c4ec420ab5dd]:
#+begin_example
   Country_China  ...  Country_Vietnam
0            0.0  ...              0.0
1            0.0  ...              0.0
2            0.0  ...              0.0
3            0.0  ...              0.0
4            0.0  ...              0.0

[5 rows x 12 columns]
#+end_example

Then we can merge it with the original.

#+begin_src python
ramen_df = ramen_df.merge(encode_df, left_index=True, right_index=True).drop("Country", axis=1)
print(ramen_df.columns)
#+end_src

#+RESULTS[30d08004ad6844e7dc88b170d35ce2bda5b32752]:
#+begin_example
Index(['Review #', 'Brand', 'Variety', 'Style', 'Stars', 'Top Ten',
       'Country_China', 'Country_Hong Kong', 'Country_Indonesia',
       'Country_Japan', 'Country_Malaysia', 'Country_Other',
       'Country_Singapore', 'Country_South Korea', 'Country_Taiwan',
       'Country_Thailand', 'Country_USA', 'Country_Vietnam'],
      dtype='object')
#+end_example

** Standarize the Data
:PROPERTIES:
:CUSTOM_ID: standarize-the-data
:END:

Now that we only have numerical data, we can stanarize to improve our model's performance.

#+begin_src python
import pandas as pd
from sklearn.preprocessing import StandardScaler

# Read in our dataset
hr_df = pd.read_csv("../resources/hr_dataset.csv")
print(hr_df.head())
#+end_src

#+RESULTS[489368e5df0e627230bc38cf77cbd6d752e4cf0e]:
#+begin_example
   Satisfaction_Level  ...  Num_Promotions
0                0.30  ...               2
1                0.25  ...               0
2                0.90  ...               5
3                0.65  ...               3
4                0.50  ...               2

[5 rows x 4 columns]
#+end_example

#+begin_src python
scaler = StandardScaler()
scaler.fit(hr_df)
scaled_data = scaler.transform(hr_df)

transformed_scaled_data = pd.DataFrame(scaled_data, columns=hr_df.columns)
print(transformed_scaled_data.head())
#+end_src

#+RESULTS[01993963e3d89562325a8775b8613d3255cd2231]:
#+begin_example
   Satisfaction_Level  ...  Num_Promotions
0           -1.303615  ...       -0.558656
1           -1.512945  ...       -1.804887
2            1.208335  ...        1.310692
3            0.161689  ...        0.064460
4           -0.466299  ...       -0.558656

[5 rows x 4 columns]
#+end_example


* Neural Network Example 3
:PROPERTIES:
:CUSTOM_ID: neural-network-example-3
:END:

** Load the Data
:PROPERTIES:
:CUSTOM_ID: load-the-data
:END:

#+begin_src python :results file :wrap org
import pandas as pd
import matplotlib as plt
import sklearn as skl
import tensorflow as tf
import matplotlib.pyplot as plt
from sklearn.datasets import make_moons

# Creating dummy nonlinear data
X_moons, y_moons = make_moons(n_samples=1000, noise=0.08, random_state=78)

# Transforming y_moons to a vertical vector
y_moons = y_moons.reshape(-1, 1)

# Creating a DataFrame to plot the nonlinear dummy data
df_moons = pd.DataFrame(X_moons, columns=["Feature 1", "Feature 2"])
df_moons["Target"] = y_moons

# Plot the nonlinear dummy data
file = "../resources/moon1.png"
fig, ax = plt.subplots()
ax.scatter(
    x=df_moons["Feature 1"],
    y=df_moons["Feature 2"],
    c=df_moons["Target"],
    cmap="winter",
)
fig.savefig(file)
print(file)
#+end_src

#+RESULTS[ccda1d1289a3dd35684ff8a76be5c971444af6b2]:
#+begin_org
[[file:../resources/moon1.png]]
#+end_org

** Prepare the data

#+begin_src python
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X_moons, y_moons, random_state=78)

X_scaler = skl.preprocessing.StandardScaler()
X_scaler.fit(X_train)

X_train_scaled = X_scaler.transform(X_train)
X_test_scaled = X_scaler.transform(X_test)

print(X_train_scaled.shape, X_test_scaled.shape)
#+end_src

#+RESULTS[f285efc6bb77c113d5b305854978c3d561be3f3f]:
#+begin_example
(750, 2) (250, 2)
#+end_example

** Create the Model
:PROPERTIES:
:CUSTOM_ID: create-the-model
:END:

We will add our first Dense layer, including the input layer. Then add the output layer with a different activation function.

#+begin_src python
nn_model = tf.keras.models.Sequential()

nn_model.add(tf.keras.layers.Dense(units=1, activation="relu", input_dim=2))

nn_model.add(tf.keras.layers.Dense(units=1, activation="sigmoid"))

print(nn_model.summary())
#+end_src

#+RESULTS[37bda45d9819e1ae6b757085f226ce5986f90860]:
#+begin_example
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 dense_2 (Dense)             (None, 1)                 3

 dense_3 (Dense)             (None, 1)                 2

=================================================================
Total params: 5
Trainable params: 5
Non-trainable params: 0
_________________________________________________________________
None
#+end_example

** Compile and Fit the Model
:PROPERTIES:
:CUSTOM_ID: compile-and-fit-the-model
:END:

#+begin_src python
nn_model.compile(loss="binary_crossentropy", optimizer="adam", metrics=["accuracy"])

fit_model = nn_model.fit(X_train_scaled, y_train, epochs=100)
#+end_src

#+RESULTS[b8c9a8f08f4ad48f393889acec555641dd917961]:
#+begin_example
Epoch 1/100
 1/24 [>.............................] - ETA: 13s - loss: 0.9823 - accuracy: 0.218824/24 [==============================] - 1s 1ms/step - loss: 1.1309 - accuracy: 0.1453
Epoch 2/100
 1/24 [>.............................] - ETA: 0s - loss: 1.0801 - accuracy: 0.156224/24 [==============================] - 0s 1ms/step - loss: 1.0941 - accuracy: 0.1507
Epoch 3/100
 1/24 [>.............................] - ETA: 0s - loss: 1.1609 - accuracy: 0.156224/24 [==============================] - 0s 1ms/step - loss: 1.0611 - accuracy: 0.1507
Epoch 4/100
 1/24 [>.............................] - ETA: 0s - loss: 0.9096 - accuracy: 0.125024/24 [==============================] - 0s 1ms/step - loss: 1.0301 - accuracy: 0.1493
Epoch 5/100
 1/24 [>.............................] - ETA: 0s - loss: 1.0318 - accuracy: 0.093824/24 [==============================] - 0s 1ms/step - loss: 1.0020 - accuracy: 0.1547
Epoch 6/100
 1/24 [>.............................] - ETA: 0s - loss: 1.0526 - accuracy: 0.218824/24 [==============================] - 0s 1ms/step - loss: 0.9761 - accuracy: 0.1507
Epoch 7/100
 1/24 [>.............................] - ETA: 0s - loss: 0.9620 - accuracy: 0.125024/24 [==============================] - 0s 1ms/step - loss: 0.9525 - accuracy: 0.1493
Epoch 8/100
 1/24 [>.............................] - ETA: 0s - loss: 0.9336 - accuracy: 0.218824/24 [==============================] - 0s 1ms/step - loss: 0.9306 - accuracy: 0.1507
Epoch 9/100
 1/24 [>.............................] - ETA: 0s - loss: 0.9679 - accuracy: 0.187524/24 [==============================] - 0s 1ms/step - loss: 0.9106 - accuracy: 0.1573
Epoch 10/100
 1/24 [>.............................] - ETA: 0s - loss: 0.8688 - accuracy: 0.187524/24 [==============================] - 0s 1ms/step - loss: 0.8927 - accuracy: 0.1587
Epoch 11/100
 1/24 [>.............................] - ETA: 0s - loss: 0.8672 - accuracy: 0.093824/24 [==============================] - 0s 1ms/step - loss: 0.8762 - accuracy: 0.1587
Epoch 12/100
 1/24 [>.............................] - ETA: 0s - loss: 0.8107 - accuracy: 0.375024/24 [==============================] - 0s 1ms/step - loss: 0.8607 - accuracy: 0.1600
Epoch 13/100
 1/24 [>.............................] - ETA: 0s - loss: 0.8645 - accuracy: 0.125024/24 [==============================] - 0s 1ms/step - loss: 0.8468 - accuracy: 0.1653
Epoch 14/100
 1/24 [>.............................] - ETA: 0s - loss: 0.8672 - accuracy: 0.062524/24 [==============================] - 0s 1ms/step - loss: 0.8339 - accuracy: 0.1680
Epoch 15/100
 1/24 [>.............................] - ETA: 0s - loss: 0.8602 - accuracy: 0.125024/24 [==============================] - 0s 2ms/step - loss: 0.8221 - accuracy: 0.1667
Epoch 16/100
 1/24 [>.............................] - ETA: 0s - loss: 0.8314 - accuracy: 0.093824/24 [==============================] - 0s 2ms/step - loss: 0.8113 - accuracy: 0.1720
Epoch 17/100
 1/24 [>.............................] - ETA: 0s - loss: 0.8361 - accuracy: 0.062524/24 [==============================] - 0s 2ms/step - loss: 0.8013 - accuracy: 0.1707
Epoch 18/100
 1/24 [>.............................] - ETA: 0s - loss: 0.8210 - accuracy: 0.125024/24 [==============================] - 0s 1ms/step - loss: 0.7923 - accuracy: 0.1787
Epoch 19/100
 1/24 [>.............................] - ETA: 0s - loss: 0.8284 - accuracy: 0.093824/24 [==============================] - 0s 1ms/step - loss: 0.7838 - accuracy: 0.1827
Epoch 20/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7796 - accuracy: 0.156224/24 [==============================] - 0s 1ms/step - loss: 0.7760 - accuracy: 0.1920
Epoch 21/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7634 - accuracy: 0.218824/24 [==============================] - 0s 1ms/step - loss: 0.7687 - accuracy: 0.2147
Epoch 22/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7843 - accuracy: 0.125024/24 [==============================] - 0s 1ms/step - loss: 0.7619 - accuracy: 0.2280
Epoch 23/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7536 - accuracy: 0.250024/24 [==============================] - 0s 1ms/step - loss: 0.7555 - accuracy: 0.2453
Epoch 24/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7324 - accuracy: 0.343824/24 [==============================] - 0s 1ms/step - loss: 0.7494 - accuracy: 0.2693
Epoch 25/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7478 - accuracy: 0.187524/24 [==============================] - 0s 2ms/step - loss: 0.7437 - accuracy: 0.2880
Epoch 26/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7316 - accuracy: 0.312524/24 [==============================] - 0s 2ms/step - loss: 0.7383 - accuracy: 0.3147
Epoch 27/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7412 - accuracy: 0.250024/24 [==============================] - 0s 1ms/step - loss: 0.7331 - accuracy: 0.3320
Epoch 28/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7408 - accuracy: 0.281224/24 [==============================] - 0s 1ms/step - loss: 0.7281 - accuracy: 0.3667
Epoch 29/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7278 - accuracy: 0.312524/24 [==============================] - 0s 1ms/step - loss: 0.7235 - accuracy: 0.4000
Epoch 30/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7046 - accuracy: 0.531224/24 [==============================] - 0s 1ms/step - loss: 0.7192 - accuracy: 0.4400
Epoch 31/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7315 - accuracy: 0.375024/24 [==============================] - 0s 1ms/step - loss: 0.7151 - accuracy: 0.4867
Epoch 32/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6990 - accuracy: 0.562524/24 [==============================] - 0s 1ms/step - loss: 0.7115 - accuracy: 0.5133
Epoch 33/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7083 - accuracy: 0.531224/24 [==============================] - 0s 1ms/step - loss: 0.7081 - accuracy: 0.5213
Epoch 34/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7176 - accuracy: 0.468824/24 [==============================] - 0s 2ms/step - loss: 0.7051 - accuracy: 0.5240
Epoch 35/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7093 - accuracy: 0.468824/24 [==============================] - 0s 2ms/step - loss: 0.7025 - accuracy: 0.5293
Epoch 36/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6829 - accuracy: 0.625024/24 [==============================] - 0s 1ms/step - loss: 0.7002 - accuracy: 0.5307
Epoch 37/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6924 - accuracy: 0.562524/24 [==============================] - 0s 1ms/step - loss: 0.6982 - accuracy: 0.5307
Epoch 38/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7093 - accuracy: 0.468824/24 [==============================] - 0s 1ms/step - loss: 0.6965 - accuracy: 0.5307
Epoch 39/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7129 - accuracy: 0.437524/24 [==============================] - 0s 1ms/step - loss: 0.6952 - accuracy: 0.5307
Epoch 40/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6820 - accuracy: 0.593824/24 [==============================] - 0s 1ms/step - loss: 0.6941 - accuracy: 0.5307
Epoch 41/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6991 - accuracy: 0.500024/24 [==============================] - 0s 1ms/step - loss: 0.6934 - accuracy: 0.5307
Epoch 42/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7045 - accuracy: 0.468824/24 [==============================] - 0s 1ms/step - loss: 0.6929 - accuracy: 0.5307
Epoch 43/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7153 - accuracy: 0.406224/24 [==============================] - 0s 1ms/step - loss: 0.6925 - accuracy: 0.5307
Epoch 44/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7097 - accuracy: 0.437524/24 [==============================] - 0s 2ms/step - loss: 0.6923 - accuracy: 0.5307
Epoch 45/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7037 - accuracy: 0.468824/24 [==============================] - 0s 2ms/step - loss: 0.6921 - accuracy: 0.5307
Epoch 46/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6863 - accuracy: 0.562524/24 [==============================] - 0s 1ms/step - loss: 0.6920 - accuracy: 0.5307
Epoch 47/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6919 - accuracy: 0.531224/24 [==============================] - 0s 1ms/step - loss: 0.6920 - accuracy: 0.5307
Epoch 48/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6926 - accuracy: 0.531224/24 [==============================] - 0s 1ms/step - loss: 0.6919 - accuracy: 0.5307
Epoch 49/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7132 - accuracy: 0.406224/24 [==============================] - 0s 1ms/step - loss: 0.6918 - accuracy: 0.5307
Epoch 50/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7021 - accuracy: 0.468824/24 [==============================] - 0s 1ms/step - loss: 0.6917 - accuracy: 0.5307
Epoch 51/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7179 - accuracy: 0.375024/24 [==============================] - 0s 1ms/step - loss: 0.6917 - accuracy: 0.5307
Epoch 52/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7123 - accuracy: 0.406224/24 [==============================] - 0s 2ms/step - loss: 0.6917 - accuracy: 0.5307
Epoch 53/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7171 - accuracy: 0.375024/24 [==============================] - 0s 2ms/step - loss: 0.6917 - accuracy: 0.5307
Epoch 54/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7112 - accuracy: 0.406224/24 [==============================] - 0s 1ms/step - loss: 0.6916 - accuracy: 0.5307
Epoch 55/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6964 - accuracy: 0.500024/24 [==============================] - 0s 1ms/step - loss: 0.6916 - accuracy: 0.5307
Epoch 56/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6816 - accuracy: 0.593824/24 [==============================] - 0s 1ms/step - loss: 0.6915 - accuracy: 0.5307
Epoch 57/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6816 - accuracy: 0.593824/24 [==============================] - 0s 2ms/step - loss: 0.6915 - accuracy: 0.5307
Epoch 58/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6961 - accuracy: 0.500024/24 [==============================] - 0s 1ms/step - loss: 0.6915 - accuracy: 0.5307
Epoch 59/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6961 - accuracy: 0.500024/24 [==============================] - 0s 1ms/step - loss: 0.6915 - accuracy: 0.5307
Epoch 60/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6771 - accuracy: 0.625024/24 [==============================] - 0s 1ms/step - loss: 0.6915 - accuracy: 0.5307
Epoch 61/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6869 - accuracy: 0.562524/24 [==============================] - 0s 2ms/step - loss: 0.6915 - accuracy: 0.5307
Epoch 62/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6913 - accuracy: 0.531224/24 [==============================] - 0s 2ms/step - loss: 0.6914 - accuracy: 0.5307
Epoch 63/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6868 - accuracy: 0.562524/24 [==============================] - 0s 1ms/step - loss: 0.6914 - accuracy: 0.5307
Epoch 64/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6957 - accuracy: 0.500024/24 [==============================] - 0s 2ms/step - loss: 0.6914 - accuracy: 0.5307
Epoch 65/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6611 - accuracy: 0.750024/24 [==============================] - 0s 1ms/step - loss: 0.6914 - accuracy: 0.5307
Epoch 66/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6999 - accuracy: 0.468824/24 [==============================] - 0s 1ms/step - loss: 0.6914 - accuracy: 0.5307
Epoch 67/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7001 - accuracy: 0.468824/24 [==============================] - 0s 1ms/step - loss: 0.6914 - accuracy: 0.5307
Epoch 68/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6739 - accuracy: 0.656224/24 [==============================] - 0s 1ms/step - loss: 0.6914 - accuracy: 0.5307
Epoch 69/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7085 - accuracy: 0.406224/24 [==============================] - 0s 1ms/step - loss: 0.6914 - accuracy: 0.5307
Epoch 70/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6955 - accuracy: 0.500024/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 71/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6702 - accuracy: 0.687524/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 72/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6870 - accuracy: 0.562524/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 73/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6954 - accuracy: 0.500024/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 74/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6912 - accuracy: 0.531224/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 75/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6953 - accuracy: 0.500024/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 76/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7119 - accuracy: 0.375024/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 77/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6671 - accuracy: 0.718824/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 78/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6993 - accuracy: 0.468824/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 79/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6952 - accuracy: 0.500024/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 80/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6831 - accuracy: 0.593824/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 81/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6712 - accuracy: 0.687524/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 82/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6912 - accuracy: 0.531224/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 83/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6872 - accuracy: 0.562524/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 84/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6912 - accuracy: 0.531224/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 85/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6912 - accuracy: 0.531224/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 86/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7032 - accuracy: 0.437524/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 87/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6753 - accuracy: 0.656224/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 88/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6952 - accuracy: 0.500024/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 89/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6872 - accuracy: 0.562524/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 90/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6994 - accuracy: 0.468824/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 91/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6875 - accuracy: 0.562524/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 92/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6912 - accuracy: 0.531224/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 93/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7071 - accuracy: 0.406224/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 94/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6951 - accuracy: 0.500024/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 95/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6912 - accuracy: 0.531224/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 96/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6912 - accuracy: 0.531224/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 97/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6912 - accuracy: 0.531224/24 [==============================] - 0s 1ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 98/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7107 - accuracy: 0.375024/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 99/100
 1/24 [>.............................] - ETA: 0s - loss: 0.7026 - accuracy: 0.437524/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
Epoch 100/100
 1/24 [>.............................] - ETA: 0s - loss: 0.6990 - accuracy: 0.468824/24 [==============================] - 0s 2ms/step - loss: 0.6913 - accuracy: 0.5307
#+end_example

** Evaluate the Model

#+begin_src python
model_loss, model_accuracy = nn_model.evaluate(X_test_scaled,y_test,verbose=2)

print(f"Loss: {model_loss}, Accuracy: {model_accuracy}")
#+end_src

#+RESULTS[009c452718b647972374329330a23931b9a86052]:
#+begin_example
8/8 - 0s - loss: 0.7065 - accuracy: 0.4080 - 246ms/epoch - 31ms/step
Loss: 0.7064979076385498, Accuracy: 0.40799999237060547
#+end_example

*Note* that our loss and accuracy is bad.

** Re-create the Model, No Free Lunch!
:PROPERTIES:
:CUSTOM_ID: re-create-the-model-no-free-lunch
:END:

We will create a new neural network with more neurons. If a problem is linear, we can solve it with a single layer, if the problem can be mapped to a function, then 2 layers will be enough. However, there the hypothesis and the empirical data suggests that we don't need more than 3 layers, although it is not proven.

So we will create a 3-layer NN.

#+begin_src python
nn_model2 = tf.keras.models.Sequential()

nn_model2.add(tf.keras.layers.Dense(units=6, activation="relu", input_dim=2))

nn_model2.add(tf.keras.layers.Dense(units=1, activation="sigmoid"))

nn_model2.compile(loss="binary_crossentropy", optimizer="adam", metrics=["accuracy"])

fit_model = nn_model2.fit(X_train_scaled, y_train, epochs=100)
#+end_src

#+RESULTS[643d38aa386fdb0b30a78372e2fe0a0be2bd5797]:
#+begin_example
Epoch 1/100
 1/24 [>.............................] - ETA: 11s - loss: 0.6031 - accuracy: 0.781224/24 [==============================] - 1s 1ms/step - loss: 0.5886 - accuracy: 0.7960
Epoch 2/100
 1/24 [>.............................] - ETA: 0s - loss: 0.5481 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.5605 - accuracy: 0.8213
Epoch 3/100
 1/24 [>.............................] - ETA: 0s - loss: 0.5128 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.5332 - accuracy: 0.8440
Epoch 4/100
 1/24 [>.............................] - ETA: 0s - loss: 0.5126 - accuracy: 0.906224/24 [==============================] - 0s 2ms/step - loss: 0.5065 - accuracy: 0.8587
Epoch 5/100
 1/24 [>.............................] - ETA: 0s - loss: 0.4374 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.4808 - accuracy: 0.8693
Epoch 6/100
 1/24 [>.............................] - ETA: 0s - loss: 0.5184 - accuracy: 0.812524/24 [==============================] - 0s 2ms/step - loss: 0.4559 - accuracy: 0.8733
Epoch 7/100
 1/24 [>.............................] - ETA: 0s - loss: 0.4825 - accuracy: 0.812524/24 [==============================] - 0s 2ms/step - loss: 0.4323 - accuracy: 0.8773
Epoch 8/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3619 - accuracy: 1.000024/24 [==============================] - 0s 2ms/step - loss: 0.4102 - accuracy: 0.8787
Epoch 9/100
 1/24 [>.............................] - ETA: 0s - loss: 0.4470 - accuracy: 0.843824/24 [==============================] - 0s 1ms/step - loss: 0.3900 - accuracy: 0.8800
Epoch 10/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3363 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.3713 - accuracy: 0.8827
Epoch 11/100
 1/24 [>.............................] - ETA: 0s - loss: 0.5276 - accuracy: 0.687524/24 [==============================] - 0s 1ms/step - loss: 0.3550 - accuracy: 0.8867
Epoch 12/100
 1/24 [>.............................] - ETA: 0s - loss: 0.4216 - accuracy: 0.781224/24 [==============================] - 0s 1ms/step - loss: 0.3401 - accuracy: 0.8867
Epoch 13/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3542 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.3273 - accuracy: 0.8880
Epoch 14/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3963 - accuracy: 0.812524/24 [==============================] - 0s 2ms/step - loss: 0.3160 - accuracy: 0.8880
Epoch 15/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2388 - accuracy: 0.968824/24 [==============================] - 0s 2ms/step - loss: 0.3059 - accuracy: 0.8893
Epoch 16/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2382 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.2972 - accuracy: 0.8893
Epoch 17/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2116 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.2898 - accuracy: 0.8893
Epoch 18/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2983 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.2829 - accuracy: 0.8907
Epoch 19/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3038 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.2772 - accuracy: 0.8893
Epoch 20/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2767 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.2719 - accuracy: 0.8920
Epoch 21/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3441 - accuracy: 0.812524/24 [==============================] - 0s 2ms/step - loss: 0.2672 - accuracy: 0.8933
Epoch 22/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1584 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.2632 - accuracy: 0.8947
Epoch 23/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3483 - accuracy: 0.812524/24 [==============================] - 0s 1ms/step - loss: 0.2594 - accuracy: 0.8960
Epoch 24/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1229 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.2561 - accuracy: 0.8973
Epoch 25/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2697 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.2530 - accuracy: 0.9013
Epoch 26/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1493 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.2502 - accuracy: 0.9013
Epoch 27/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3319 - accuracy: 0.843824/24 [==============================] - 0s 1ms/step - loss: 0.2477 - accuracy: 0.9013
Epoch 28/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3008 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.2453 - accuracy: 0.9013
Epoch 29/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1873 - accuracy: 0.968824/24 [==============================] - 0s 2ms/step - loss: 0.2431 - accuracy: 0.9000
Epoch 30/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2199 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.2411 - accuracy: 0.9000
Epoch 31/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2397 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.2392 - accuracy: 0.9000
Epoch 32/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2236 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.2375 - accuracy: 0.9000
Epoch 33/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2337 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.2358 - accuracy: 0.9000
Epoch 34/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2191 - accuracy: 0.906224/24 [==============================] - 0s 2ms/step - loss: 0.2343 - accuracy: 0.8987
Epoch 35/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2006 - accuracy: 0.906224/24 [==============================] - 0s 2ms/step - loss: 0.2329 - accuracy: 0.9013
Epoch 36/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3577 - accuracy: 0.812524/24 [==============================] - 0s 2ms/step - loss: 0.2315 - accuracy: 0.9013
Epoch 37/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2875 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.2301 - accuracy: 0.9040
Epoch 38/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1702 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.2287 - accuracy: 0.9040
Epoch 39/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3302 - accuracy: 0.843824/24 [==============================] - 0s 1ms/step - loss: 0.2274 - accuracy: 0.9040
Epoch 40/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3589 - accuracy: 0.812524/24 [==============================] - 0s 1ms/step - loss: 0.2262 - accuracy: 0.9040
Epoch 41/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2619 - accuracy: 0.843824/24 [==============================] - 0s 1ms/step - loss: 0.2250 - accuracy: 0.9040
Epoch 42/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1426 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.2237 - accuracy: 0.9040
Epoch 43/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1201 - accuracy: 0.968824/24 [==============================] - 0s 2ms/step - loss: 0.2225 - accuracy: 0.9053
Epoch 44/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1915 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.2213 - accuracy: 0.9053
Epoch 45/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2155 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.2204 - accuracy: 0.9067
Epoch 46/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1741 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.2191 - accuracy: 0.9053
Epoch 47/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1087 - accuracy: 0.968824/24 [==============================] - 0s 2ms/step - loss: 0.2179 - accuracy: 0.9053
Epoch 48/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1493 - accuracy: 0.937524/24 [==============================] - 0s 2ms/step - loss: 0.2167 - accuracy: 0.9053
Epoch 49/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2087 - accuracy: 0.843824/24 [==============================] - 0s 2ms/step - loss: 0.2155 - accuracy: 0.9067
Epoch 50/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1350 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.2144 - accuracy: 0.9080
Epoch 51/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1742 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.2132 - accuracy: 0.9080
Epoch 52/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1960 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.2120 - accuracy: 0.9093
Epoch 53/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1397 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.2107 - accuracy: 0.9093
Epoch 54/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2969 - accuracy: 0.812524/24 [==============================] - 0s 2ms/step - loss: 0.2094 - accuracy: 0.9093
Epoch 55/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2724 - accuracy: 0.875024/24 [==============================] - 0s 2ms/step - loss: 0.2082 - accuracy: 0.9107
Epoch 56/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2531 - accuracy: 0.906224/24 [==============================] - 0s 2ms/step - loss: 0.2069 - accuracy: 0.9107
Epoch 57/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2706 - accuracy: 0.812524/24 [==============================] - 0s 1ms/step - loss: 0.2056 - accuracy: 0.9107
Epoch 58/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2882 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.2043 - accuracy: 0.9120
Epoch 59/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3524 - accuracy: 0.843824/24 [==============================] - 0s 1ms/step - loss: 0.2029 - accuracy: 0.9120
Epoch 60/100
 1/24 [>.............................] - ETA: 0s - loss: 0.0876 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.2016 - accuracy: 0.9133
Epoch 61/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2994 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.2003 - accuracy: 0.9147
Epoch 62/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1132 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.1988 - accuracy: 0.9147
Epoch 63/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1121 - accuracy: 0.968824/24 [==============================] - 0s 2ms/step - loss: 0.1974 - accuracy: 0.9160
Epoch 64/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1330 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.1962 - accuracy: 0.9160
Epoch 65/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2446 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.1946 - accuracy: 0.9173
Epoch 66/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2947 - accuracy: 0.781224/24 [==============================] - 0s 1ms/step - loss: 0.1932 - accuracy: 0.9187
Epoch 67/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3006 - accuracy: 0.875024/24 [==============================] - 0s 2ms/step - loss: 0.1918 - accuracy: 0.9187
Epoch 68/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1593 - accuracy: 0.937524/24 [==============================] - 0s 2ms/step - loss: 0.1903 - accuracy: 0.9187
Epoch 69/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2214 - accuracy: 0.937524/24 [==============================] - 0s 2ms/step - loss: 0.1889 - accuracy: 0.9187
Epoch 70/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1288 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.1874 - accuracy: 0.9187
Epoch 71/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1094 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.1860 - accuracy: 0.9187
Epoch 72/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1370 - accuracy: 0.968824/24 [==============================] - 0s 2ms/step - loss: 0.1846 - accuracy: 0.9187
Epoch 73/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2590 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.1831 - accuracy: 0.9187
Epoch 74/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1603 - accuracy: 0.906224/24 [==============================] - 0s 2ms/step - loss: 0.1816 - accuracy: 0.9187
Epoch 75/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1888 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.1801 - accuracy: 0.9187
Epoch 76/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2049 - accuracy: 0.937524/24 [==============================] - 0s 2ms/step - loss: 0.1785 - accuracy: 0.9187
Epoch 77/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1862 - accuracy: 0.906224/24 [==============================] - 0s 2ms/step - loss: 0.1771 - accuracy: 0.9213
Epoch 78/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1979 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.1755 - accuracy: 0.9213
Epoch 79/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2086 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.1740 - accuracy: 0.9253
Epoch 80/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1371 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.1726 - accuracy: 0.9267
Epoch 81/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2592 - accuracy: 0.843824/24 [==============================] - 0s 2ms/step - loss: 0.1710 - accuracy: 0.9280
Epoch 82/100
 1/24 [>.............................] - ETA: 0s - loss: 0.0670 - accuracy: 1.000024/24 [==============================] - 0s 1ms/step - loss: 0.1695 - accuracy: 0.9280
Epoch 83/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1598 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.1680 - accuracy: 0.9280
Epoch 84/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1470 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.1664 - accuracy: 0.9280
Epoch 85/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1377 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.1649 - accuracy: 0.9280
Epoch 86/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2528 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.1635 - accuracy: 0.9293
Epoch 87/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2004 - accuracy: 0.906224/24 [==============================] - 0s 2ms/step - loss: 0.1619 - accuracy: 0.9307
Epoch 88/100
 1/24 [>.............................] - ETA: 0s - loss: 0.0913 - accuracy: 0.968824/24 [==============================] - 0s 2ms/step - loss: 0.1604 - accuracy: 0.9307
Epoch 89/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1188 - accuracy: 0.937524/24 [==============================] - 0s 2ms/step - loss: 0.1588 - accuracy: 0.9307
Epoch 90/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2019 - accuracy: 0.906224/24 [==============================] - 0s 1ms/step - loss: 0.1573 - accuracy: 0.9307
Epoch 91/100
 1/24 [>.............................] - ETA: 0s - loss: 0.0780 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.1558 - accuracy: 0.9320
Epoch 92/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1108 - accuracy: 0.968824/24 [==============================] - 0s 1ms/step - loss: 0.1543 - accuracy: 0.9320
Epoch 93/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1688 - accuracy: 0.937524/24 [==============================] - 0s 2ms/step - loss: 0.1527 - accuracy: 0.9320
Epoch 94/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2354 - accuracy: 0.875024/24 [==============================] - 0s 2ms/step - loss: 0.1512 - accuracy: 0.9333
Epoch 95/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2484 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.1497 - accuracy: 0.9347
Epoch 96/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1271 - accuracy: 0.937524/24 [==============================] - 0s 1ms/step - loss: 0.1482 - accuracy: 0.9360
Epoch 97/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1428 - accuracy: 0.875024/24 [==============================] - 0s 1ms/step - loss: 0.1467 - accuracy: 0.9373
Epoch 98/100
 1/24 [>.............................] - ETA: 0s - loss: 0.3454 - accuracy: 0.781224/24 [==============================] - 0s 1ms/step - loss: 0.1452 - accuracy: 0.9373
Epoch 99/100
 1/24 [>.............................] - ETA: 0s - loss: 0.1978 - accuracy: 0.875024/24 [==============================] - 0s 2ms/step - loss: 0.1437 - accuracy: 0.9373
Epoch 100/100
 1/24 [>.............................] - ETA: 0s - loss: 0.2224 - accuracy: 0.875024/24 [==============================] - 0s 2ms/step - loss: 0.1423 - accuracy: 0.9373
#+end_example

** Evaluate the Model

#+begin_src python
model_loss, model_accuracy = nn_model2.evaluate(X_test_scaled,y_test,verbose=2)
print(f"Loss: {model_loss}, Accuracy: {model_accuracy}")
#+end_src

#+RESULTS[12ec23189bfd9dbafd64cdb0d869c65affc9f4aa]:
#+begin_example
8/8 - 0s - loss: 0.1510 - accuracy: 0.9240 - 184ms/epoch - 23ms/step
Loss: 0.15098616480827332, Accuracy: 0.9240000247955322
#+end_example

*Note* that the performance of the model is much better after we changed our NN.

However, the deeper our NN, the more resources and longer time it will take for it to accomplish it's task. So we must find a compromise when the difference on accuracy is small. We may want to do feature engineering or adding more neurons over adding more layers.

* Addressing Overfitting and Underfitting
:PROPERTIES:
:CUSTOM_ID: addressing-overfitting-and-underfitting
:END:

** Getting Rid of Outliers
:PROPERTIES:
:CUSTOM_ID: getting-rid-of-outliers
:END:

We can apply the Interquartile Range[fn:3] to get rid of outliers before training the model.

** Work with Hyperparameters
:PROPERTIES:
:CUSTOM_ID: work-with-hyperparameters
:END:

We have many hyperparameters in a NN, some of them include:

1. The number of neurons in a hidden layer
2. The number of hidden layers
3. The loss function
4. The optimization model
5. The number of epochs in the training
6. The activation function for each layer

Some heuristics for working with hyperparameters are:

1. Use 3 times as many neurons as features distributed amongst the layers.
2. Try selecting slightly more complex activation functions for the hidden layers than the output layers.
3. If the model doesn't meet the expectations after changing the activation function, then increase the epochs.
4. If the model produces weight coefficients that are too effective at analyzing the training data, it won't generalize well.

| Adjustment                 | Pros                                                          | Cons                               |
|----------------------------+---------------------------------------------------------------+------------------------------------|
| Add neurons                | Speeds up, reduce cost                                        | More computational resources used  |
| Add layers                 | More interactions between variables                           | More computational resources used  |
| Change activation function | Changes how a model interprets the inputs                     | Interpretations can be ineffective |
| Add epochs                 | Increases likehood that the model will achieve optimal weight coefficients | Increased risk of overfitting      |

* Model Optimization and Keras Tuner
:PROPERTIES:
:CUSTOM_ID: model-optimization-and-keras-tuner
:END:

Model optimization is often the most tedious and critical step of training a neural network.

Keras Tuners takes a Keras class, creates many possible combinations with parameters and compares them[fn:4].

** Imports

#+begin_src python :exports code
import pandas as pd
import matplotlib.pyplot as plt
import sklearn as skl
import tensorflow as tf
from sklearn.datasets import make_circles
from sklearn.model_selection import train_test_split
import keras_tuner as kt
#+end_src

#+RESULTS[0afa1ee1f05051529646e4ae3339cbc31c010645]:
#+begin_example
#+end_example

** Prepare the Data

#+begin_src python
X_circles, y_circles1 = make_circles(n_samples=1000, noise=0.05, random_state=78)
y_circles = y_circles1.reshape(-1, 1)

X_train, X_test, y_train, y_test = train_test_split(X_circles, y_circles, random_state=78)

X_scaler = skl.preprocessing.StandardScaler()
X_scaler.fit(X_train)

X_train_scaled = X_scaler.transform(X_train)
X_test_scaled = X_scaler.transform(X_test)

print(X_circles.shape, y_circles.shape)
print(X_train_scaled.shape, X_test_scaled.shape)
#+end_src

#+RESULTS[06b0e8f8d4a89345daf2465d0c9107c96d58e9c0]:
#+begin_example
(1000, 2) (1000, 1)
(750, 2) (250, 2)
#+end_example

** Visualize the Data
:PROPERTIES:
:CUSTOM_ID: visualize-the-data
:END:

#+begin_src python
df = pd.DataFrame(
    X_circles,
    columns=["x", "y"]
)
df["class"] = y_circles
print(df.head())
#+end_src

#+RESULTS[7aeb5a4dd0ace37258134b33530a5f094d4c3679]:
#+begin_example
          x         y  class
0 -0.134168  1.023486      0
1 -0.279758 -0.726811      1
2  0.810913 -0.470461      0
3 -0.875263  0.552636      0
4  0.421407 -0.714531      1
#+end_example

#+begin_src python :results file :wrap org
file = "../resources/for_keras_tuner.png"
fig, ax = plt.subplots()
ax.scatter(
    df[df['class'] == 0]['x'],
    df[df['class'] == 0]['y'],
)
ax.scatter(
    df[df['class'] == 1]['x'],
    df[df['class'] == 1]['y'],
)
fig.savefig(file)
print(file)
#+end_src

#+RESULTS[10d2c9dd71e2fce6fb337ce4cf3ab24884d048f9]:
#+begin_org
[[file:../resources/for_keras_tuner.png]]
#+end_org

** Create a Factory Function
:PROPERTIES:
:CUSTOM_ID: create-a-factory-function
:END:

This function acts as a callback function. It takes the hyperparameters of the tuner and returns a model. This will be the first argument for the tuner whenever we create it.

#+begin_src python
def create_model(hp: keras_tuner.HyperParameters) -> tf.keras.Model:
    """Uses the HyperParameters from a Keras Tuner and returns a Keras Model"""
    nn_model = tf.keras.models.Sequential()

    activation = hp.Choice('activation', ['relu', 'tanh', 'sigmoid'])

    nn_model.add(
        tf.keras.layers.Dense(
            units=hp.Int(
                'first_units',
                min_value=1,
                max_value=10,
                step=2,
            ),
                activation=activation,
                input_dim=2
        ))
    for i in range(hp.Int('num_layers', 1, 6)):
        nn_model.add(
            tf.keras.layers.Dense(
                units=hp.Int(
                    'units_' + str(i),
                    min_value=1,
                    max_value=10,
                    step=2,
                ),
                activation=activation
            ))
    nn_model.add(tf.keras.layers.Dense(units=1, activation="sigmoid"))

    nn_model.compile(
        loss="binary_crossentropy",
        optimizer='adam',
        metrics=['accuracy'],
    )
    return nn_model

print(create_model)
#+end_src

#+RESULTS[eedb8ba7262a244fcabedb3c335532354fabe78a]:
#+begin_example
<function create_model at 0x157492830>
#+end_example

** Use Keras Tuner
:PROPERTIES:
:CUSTOM_ID: use-keras-tuner
:END:

We create a tuner object and then use the =search= method for finding the best hyperparameters (takes a while).

#+begin_src python
tuner = kt.Hyperband(
    create_model,
    objective="val_accuracy",
    max_epochs=20,
    hyperband_iterations=2
)
print(tuner)
#+end_src

#+RESULTS[568921416b248ec5f5ab4b81e2ff40954ce2eb4c]:
#+begin_example
<keras_tuner.tuners.hyperband.Hyperband object at 0x1591a66d0>
#+end_example

#+begin_src python
tuner.search(X_train_scaled, y_train, epochs=20, validation_data=(X_test_scaled, y_test), verbose=0)
#+end_src

#+RESULTS[b3e08240cbd6d31d81177fef0ec68c2273472149]:
#+begin_example
INFO:tensorflow:Oracle triggered exit
#+end_example

#+begin_src python
best_hyper = tuner.get_best_hyperparameters(1)[0]
print(best_hyper.values)
#+end_src

#+RESULTS[e72dbfbd0e7afb65ec6400f1cf72cb50fadd5706]:
#+begin_example
{'activation': 'relu', 'first_units': 9, 'num_layers': 6, 'units_0': 5, 'units_1': 5, 'units_2': 9, 'units_3': 9, 'units_4': 9, 'units_5': 7, 'tuner/epochs': 20, 'tuner/initial_epoch': 0, 'tuner/bracket': 0, 'tuner/round': 0}
#+end_example

** Get the Best Model
:PROPERTIES:
:CUSTOM_ID: get-the-best-model
:END:

#+begin_src python
best_model = tuner.get_best_models(1)[0]
model_loss, model_accuracy = best_model.evaluate(X_test_scaled, y_test, verbose=2)
print(f"Loss: {model_loss}, Accuracy: {model_accuracy}")
#+end_src

#+RESULTS[a6777e2ee0a431eac1acf94ea8502cee1f1829e4]:
#+begin_example
8/8 - 0s - loss: 0.1603 - accuracy: 0.9560 - 291ms/epoch - 36ms/step
Loss: 0.16025976836681366, Accuracy: 0.9559999704360962
#+end_example


* Footnotes
:PROPERTIES:
:CUSTOM_ID: footnotes
:END:
[fn:4]https://keras.io/api/keras_tuner/hyperparameters/

[fn:3]https://www.scribbr.com/statistics/interquartile-range/#:~:text=The%20interquartile%20range%20(IQR)%20contains,half%20of%20a%20data%20set.
[fn:2]https://www.tensorflow.org/guide/keras/sequential_model

[fn:1]https://keras.io/api/layers/activations/
